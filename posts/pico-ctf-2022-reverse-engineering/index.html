<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Pico CTF 2022: Reverse-Engineering 🛠 💾" /><meta property="og:locale" content="en" /><meta name="description" content="file-run1" /><meta property="og:description" content="file-run1" /><link rel="canonical" href="https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/" /><meta property="og:url" content="https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/" /><meta property="og:site_name" content="(B)rootware Research" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-01T11:45:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Pico CTF 2022: Reverse-Engineering 🛠 💾" /><meta name="twitter:site" content="@brootware" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-04-04T11:49:00+08:00","datePublished":"2022-04-01T11:45:00+08:00","description":"file-run1","mainEntityOfPage":{"@type":"WebPage","@id":"https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/"},"url":"https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/","@type":"BlogPosting","headline":"Pico CTF 2022: Reverse-Engineering 🛠 💾","@context":"https://schema.org"}</script><title>Pico CTF 2022: Reverse-Engineering 🛠 💾 | (B)rootware Research</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="(B)rootware Research"><meta name="application-name" content="(B)rootware Research"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7734956?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">(B)rootware Research</a></div><div class="site-subtitle font-italic">Cloud DevOps / Site Reliability Engineering, Cyber Security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/brootware" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/brootware" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/oakermin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Pico CTF 2022: Reverse-Engineering 🛠 💾</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Pico CTF 2022: Reverse-Engineering 🛠 💾</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/brootware">Oaker Min (Bruce)</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-04-01 11:45:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Fri, Apr 1, 2022, 11:45 AM +0800" >Apr 1, 2022</em> </span> <span> Updated <em class="timeago" date="2022-04-04 11:49:00 +0800 " data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 4, 2022, 11:49 AM +0800" >Apr 4, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2969 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><h2 id="file-run1">file-run1<a href="#file-run1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>A program has been provided to you, what happens if you try to run it on the command line? Download the program here.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>➜  revEngineer <span class="nb">ls
</span>run
➜  revEngineer file run 
run: ELF 64-bit LSB shared object, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]<span class="o">=</span>f9df27b4be0359f544470c9df7db39f209366c6c, <span class="k">for </span>GNU/Linux 3.2.0, not stripped
➜  revEngineer <span class="nb">chmod</span> +x run 
➜  revEngineer ./run 
The flag is: picoCTF<span class="o">{</span>U51N6_Y0Ur_F1r57_F113_5578e314<span class="o">}</span>
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{U51N6_Y0Ur_F1r57_F113_5578e314}</code></p><h2 id="file-run2">file-run2<a href="#file-run2" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Another program, but this time, it seems to want some input. What happens if you try to run it on the command line with input “Hello!”? Download the program here.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>➜  file-run2 <span class="nb">chmod</span> +x run 
➜  file-run2 ./run Hello!
The flag is: picoCTF<span class="o">{</span>F1r57_4rgum3n7_981abfb5<span class="o">}</span>
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{F1r57_4rgum3n7_981abfb5}</code></p><h2 id="gdb-test-drive">GDB Test Drive<a href="#gdb-test-drive" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Download this binary. Here’s the test drive instructions:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">chmod</span> +x gdbme
<span class="nv">$ </span>gdb gdbme
<span class="o">(</span>gdb<span class="o">)</span> layout asm
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">break</span> <span class="k">*</span><span class="o">(</span>main+99<span class="o">)</span>
<span class="o">(</span>gdb<span class="o">)</span> run
<span class="o">(</span>gdb<span class="o">)</span> jump <span class="k">*</span><span class="o">(</span>main+104<span class="o">)</span>
</pre></table></code></div></div><p><img data-src="https://bn1304files.storage.live.com/y4mOnMFNBYYvHqB8_ZnB0U-CeIMG70PQecKXO5ufMCV4vJcyyKBiLmxKWPWVN3lkmsJuV-Ypp7X80i6nHCjNkeWPNihCWOWF-8sWa0ZAiS6JGTr7H6kjQex3hmBXbhSqbtniMHZFAuh8M9d19xdTZaAq35Qc8oXvOFax7dZVH1MynwMbV2dD8rigPUSHW5wS4Wz?width=2750&amp;height=1658&amp;cropmode=none" alt="image" data-proofer-ignore></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="o">(</span>gdb<span class="o">)</span> <span class="nb">break</span> <span class="k">*</span><span class="o">(</span>main+99<span class="o">)</span>
Breakpoint 1 at 0x132a
<span class="o">(</span>gdb<span class="o">)</span> run
Starting program: /cases/pico2022/revEngineer/gbdtestdrive/gdbme

Breakpoint 1, 0x000055555555532a <span class="k">in </span>main <span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span> jump <span class="k">*</span><span class="o">(</span>main+104<span class="o">)</span>
Continuing at 0x55555555532f.
picoCTF<span class="o">{</span>d3bugg3r_dr1v3_93b87433<span class="o">}</span>
<span class="o">(</span>gdb<span class="o">)</span> ior 1 <span class="o">(</span>process 23118<span class="o">)</span> exited normally]
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{d3bugg3r_dr1v3_93b87433}</code></p><h2 id="patchmepy">patchme.py<a href="#patchmepy" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Run this Python program in the same directory as this encrypted flag.</p><p>patchme.flag.py</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c1">#### THIS FUNCTION WILL NOT HELP YOU FIND THE FLAG --LT ########################
</span><span class="k">def</span> <span class="nf">str_xor</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="c1">#extend key to secret length
</span>    <span class="n">new_key</span> <span class="o">=</span> <span class="n">key</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">secret</span><span class="p">):</span>
        <span class="n">new_key</span> <span class="o">=</span> <span class="n">new_key</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>        
    <span class="k">return</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">secret_c</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">new_key_c</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">secret_c</span><span class="p">,</span><span class="n">new_key_c</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span><span class="n">new_key</span><span class="p">)])</span>
<span class="c1">###############################################################################
</span>

<span class="n">flag_enc</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt.enc'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>



<span class="k">def</span> <span class="nf">level_1_pw_check</span><span class="p">():</span>
    <span class="n">user_pw</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter correct password for flag: "</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">user_pw</span> <span class="o">==</span> <span class="s">"ak98"</span> <span class="o">+</span> \
                   <span class="s">"-=90"</span> <span class="o">+</span> \
                   <span class="s">"adfjhgj321"</span> <span class="o">+</span> \
                   <span class="s">"sleuth9000"</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Welcome back... your flag, user:"</span><span class="p">)</span>
        <span class="n">decryption</span> <span class="o">=</span> <span class="n">str_xor</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">.</span><span class="n">decode</span><span class="p">(),</span> <span class="s">"utilitarian"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">decryption</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"That password is incorrect"</span><span class="p">)</span>



<span class="n">level_1_pw_check</span><span class="p">()</span>
</pre></table></code></div></div><p>We simply need to change the if condition as below to decrypt the flag regardless of incorrect password.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">level_1_pw_check</span><span class="p">():</span>
    <span class="n">user_pw</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter correct password for flag: "</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="n">user_pw</span> <span class="o">!=</span> <span class="s">"ak98"</span> <span class="o">+</span> \
                   <span class="s">"-=90"</span> <span class="o">+</span> \
                   <span class="s">"adfjhgj321"</span> <span class="o">+</span> \
                   <span class="s">"sleuth9000"</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Welcome back... your flag, user:"</span><span class="p">)</span>
        <span class="n">decryption</span> <span class="o">=</span> <span class="n">str_xor</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">.</span><span class="n">decode</span><span class="p">(),</span> <span class="s">"utilitarian"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">decryption</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"That password is incorrect"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>python patchme.flag.py 
Please enter correct password <span class="k">for </span>flag: haha
Welcome back... your flag, user:
picoCTF<span class="o">{</span>p47ch1ng_l1f3_h4ck_4d5af99c<span class="o">}</span>
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{p47ch1ng_l1f3_h4ck_4d5af99c}</code></p><h2 id="safe-opener">Safe Opener<a href="#safe-opener" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you open this safe? I forgot the key to my safe but this program is supposed to help me with retrieving the lost key. Can you help me unlock my safe? Put the password you recover into the picoCTF flag format like: picoCTF{password}</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SafeOpener</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">args</span><span class="o">[])</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">BufferedReader</span> <span class="n">keyboard</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">));</span>
        <span class="nc">Base64</span><span class="o">.</span><span class="na">Encoder</span> <span class="n">encoder</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">encodedkey</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">boolean</span> <span class="n">isOpen</span><span class="o">;</span>
        

        <span class="k">while</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Enter password for the safe: "</span><span class="o">);</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">keyboard</span><span class="o">.</span><span class="na">readLine</span><span class="o">();</span>

            <span class="n">encodedkey</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">encodedkey</span><span class="o">);</span>
              
            <span class="n">isOpen</span> <span class="o">=</span> <span class="n">openSafe</span><span class="o">(</span><span class="n">encodedkey</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">isOpen</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"You have  "</span> <span class="o">+</span> <span class="o">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">i</span><span class="o">)</span> <span class="o">+</span> <span class="s">" attempt(s) left"</span><span class="o">);</span>
                <span class="n">i</span><span class="o">++;</span>
                <span class="k">continue</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">openSafe</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">encodedkey</span> <span class="o">=</span> <span class="s">"cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz"</span><span class="o">;</span>
        
        <span class="k">if</span> <span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">encodedkey</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sesame open"</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Password is incorrect\n"</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>You’re given a java program to reverse engineer the password from. From the program we can see that the password string is encoded in base64. We can simply do as below.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>➜  safeopener <span class="nb">echo</span> <span class="s1">'cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz'</span> | <span class="nb">base64</span> <span class="nt">-d</span>
pl3as3_l3t_m3_1nt0_th3_saf3
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>➜  safeopener java SafeOpener
Enter password <span class="k">for </span>the safe: pl3as3_l3t_m3_1nt0_th3_saf3
cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz
Sesame open
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{pl3as3_l3t_m3_1nt0_th3_saf3}</code></p><h2 id="unpackmepy">unpackme.py<a href="#unpackmepy" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Reverse engineer this Python program.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'gAAAAABiMD1Dt87s50caSunQlHoZqPOwtGNaQXexN-gjKwZeuLEN_-v6UcFJHVXOT4B6DcD1SB7cnd6yTcHg9e9LZCAeJY2cJ0r0sfyGPRiH60F-WbkyUjlAdDywI8RPdTpDYLuBmpZ_Kun-kHyTzMjeKR6R26Z4JITUS8n7Dj9X--9eNLajH6UuYD4GkjRACpsidl_8z33DlB86u_xDCMMm7HFK2oJTs8HG1fBex6enQsu0frUAJbx56DxhRvWawAysDMtLE50vaohrzkVV7Yaz4ClilwgfjQ=='</span>

<span class="n">key_str</span> <span class="o">=</span> <span class="s">'correctstaplecorrectstaplecorrec'</span>
<span class="n">key_base64</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">key_str</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key_base64</span><span class="p">)</span>
<span class="n">plain</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="k">exec</span><span class="p">(</span><span class="n">plain</span><span class="p">.</span><span class="n">decode</span><span class="p">())</span>
</pre></table></code></div></div><p>We can simply run the program line by line via python interpreter to reverse engineer the code.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'gAAAAABiMD1Dt87s50caSunQlHoZqPOwtGNaQXexN-gjKwZeuLEN_-v6UcFJHVXOT4B6DcD1SB7cnd6yTcHg9e9LZCAeJY2cJ0r0sfyGPRiH60F-WbkyUjlAdDywI8RPdTpDYLuBmpZ_Kun-kHyTzMjeKR6R26Z4JITUS8n7Dj9X--9eNLajH6UuYD4GkjRACpsidl_8z33DlB86u_xDCMMm7HFK2oJTs8HG1fBex6enQsu0frUAJbx56DxhRvWawAysDMtLE50vaohrzkVV7Yaz4ClilwgfjQ=='</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">key_str</span> <span class="o">=</span> <span class="s">'correctstaplecorrectstaplecorrec'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">key_base64</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">key_str</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">key_base64</span>
<span class="sa">b</span><span class="s">'Y29ycmVjdHN0YXBsZWNvcnJlY3RzdGFwbGVjb3JyZWM='</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key_base64</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span>
<span class="o">&lt;</span><span class="n">cryptography</span><span class="p">.</span><span class="n">fernet</span><span class="p">.</span><span class="n">Fernet</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7fc9bb354dc0</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plain</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plain</span>
<span class="sa">b</span><span class="s">"</span><span class="se">\n</span><span class="s">pw = input('What</span><span class="se">\\</span><span class="s">'s the password? ')</span><span class="se">\n\n</span><span class="s">if pw == 'batteryhorse':</span><span class="se">\n</span><span class="s">  print('picoCTF{175_chr157m45_8aef58d2}')</span><span class="se">\n</span><span class="s">else:</span><span class="se">\n</span><span class="s">  print('That password is incorrect.')</span><span class="se">\n\n</span><span class="s">"</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>➜  unpackmepy python unpackme.flag.py 
What<span class="s1">'s the password? batteryhorse
picoCTF{175_chr157m45_8aef58d2}
</span></pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{175_chr157m45_8aef58d2}</code></p><h2 id="bloatpy">bloat.py<a href="#bloatpy" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Run this Python program in the same directory as this encrypted flag.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>➜  bloatpy python bloat.flag.py 
Please enter correct password <span class="k">for </span>flag: dunno
That password is incorrect
</pre></table></code></div></div><p>Reviewing the python program, the function <code class="language-plaintext highlighter-rouge">arg133()</code> seems to be the place where the program is checking for user input for correct password.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="n">arg432</span> <span class="o">==</span> <span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">88</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">77</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">a</span> <span class="o">=</span> <span class="s">"!</span><span class="se">\"</span><span class="s">#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="o">+</span> \
            <span class="s">"[</span><span class="se">\\</span><span class="s">]^_`abcdefghijklmnopqrstuvwxyz{|}~ "</span>

<span class="k">def</span> <span class="nf">arg133</span><span class="p">(</span><span class="n">arg432</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">arg432</span> <span class="o">==</span> <span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">88</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">77</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">True</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">51</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">83</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">86</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">67</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">72</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">72</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">77</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">83</span><span class="p">])</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">arg111</span><span class="p">(</span><span class="n">arg444</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">arg122</span><span class="p">(</span><span class="n">arg444</span><span class="p">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">75</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">75</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">72</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">77</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">arg232</span><span class="p">():</span>
  <span class="k">return</span> <span class="nb">input</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">47</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">75</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">77</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">83</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">83</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">86</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">67</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">69</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">69</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">75</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">70</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">arg132</span><span class="p">():</span>
  <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="s">'flag.txt.enc'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">arg112</span><span class="p">():</span>
  <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">54</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">75</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">76</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">65</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">74</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">88</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">84</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">69</span><span class="p">]</span><span class="o">+</span>\
<span class="n">a</span><span class="p">[</span><span class="mi">75</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">70</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">94</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">84</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">81</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">arg122</span><span class="p">(</span><span class="n">arg432</span><span class="p">,</span> <span class="n">arg423</span><span class="p">):</span>
    <span class="n">arg433</span> <span class="o">=</span> <span class="n">arg423</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg433</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg432</span><span class="p">):</span>
        <span class="n">arg433</span> <span class="o">=</span> <span class="n">arg433</span> <span class="o">+</span> <span class="n">arg423</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg423</span><span class="p">)</span>        
    <span class="k">return</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">arg422</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">arg442</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">arg422</span><span class="p">,</span><span class="n">arg442</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">arg432</span><span class="p">,</span><span class="n">arg433</span><span class="p">)])</span>
    
<span class="n">arg444</span> <span class="o">=</span> <span class="n">arg132</span><span class="p">()</span>
<span class="n">arg432</span> <span class="o">=</span> <span class="n">arg232</span><span class="p">()</span>
<span class="n">arg133</span><span class="p">(</span><span class="n">arg432</span><span class="p">)</span>
<span class="n">arg112</span><span class="p">()</span>
<span class="n">arg423</span> <span class="o">=</span> <span class="n">arg111</span><span class="p">(</span><span class="n">arg444</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">arg423</span><span class="p">)</span>
<span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><p>So we can simply reverse engineer the password from the python interpreter as below.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="s">"!</span><span class="se">\"</span><span class="s">#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="o">+</span> \
            <span class="s">"[</span><span class="se">\\</span><span class="s">]^_`abcdefghijklmnopqrstuvwxyz{|}~ "</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">79</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">88</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">71</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">77</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">66</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="mi">68</span><span class="p">]</span>
<span class="s">'happychance'</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>➜  bloatpy python bloat.flag.py 
Please enter correct password <span class="k">for </span>flag: happychance
Welcome back... your flag, user:
picoCTF<span class="o">{</span>d30bfu5c4710n_f7w_c47f9e9c<span class="o">}</span>
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{d30bfu5c4710n_f7w_c47f9e9c}</code></p><h2 id="fresh-java">Fresh java<a href="#fresh-java" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Reverse engineer this Java program.</p><p>The java program is loaded into ghidra.</p><p><img data-src="https://bn1304files.storage.live.com/y4mTarSwIjZaWdy2yGbyHnir3TbP0GL0fPaHD1enBKLCIGTLpvaDCzH3WZQPE6wZeqYUK23825rsncI8lugUbvZ7FM7FhjGIUXmMy0HW5MxLPrIAHLR89q6FUJkodF0V6tvQZbwTV7Hw1TnBL5gDDwPG1XBu6KPzsSiWtMR-DMAnI9kcxHte0DvFOmehX-LX3I7?width=2860&amp;height=1724&amp;cropmode=none" alt="ghidra" data-proofer-ignore></p><p>From the program’s logic, we can see that it is checking each character for correct password. From here we can manually reverse engineer the password.</p><p><img data-src="https://bn1304files.storage.live.com/y4m6kgyqvVVFRCCCj7hSSKhvoqlujSzdCac6asg7C8Tb_cSlJ3sGy9sBQc-GNzB0SV55kqjNOPzRGrvi2I1xSURcFOJ2sZlE5bIb3xyKhO9AuE6HIzwFDh0F7xoeXXxV8n206Dj4d2S_i_8mBfg-4esLCTMDgYsu6GId-EySQtIqzAlXm2bALTQPQAQzniJ9uBw?width=2860&amp;height=1732&amp;cropmode=none" alt="repasswd" data-proofer-ignore></p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
</pre><td class="rouge-code"><pre>  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x21</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'}'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x20</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'0'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x1f</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'f'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x1e</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'9'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x1d</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'5'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x1c</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'c'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x1b</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'6'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x1a</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'2'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x19</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'1'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x18</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'_'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x17</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'d'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x16</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'3'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x15</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'r'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x14</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'1'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x13</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'u'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x12</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'q'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x11</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'3'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0x10</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'r'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0xf</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'_'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0xe</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'g'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0xd</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'n'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0xc</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'1'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mh">0xb</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'l'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'0'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">9</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'0'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'7'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'{'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">6</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'F'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'T'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'C'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'o'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'c'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'i'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="n">cVar3</span> <span class="o">=</span> <span class="n">objectRef</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'p'</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pPVar1</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">;</span>
    <span class="n">pPVar1</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Invalid key"</span><span class="o">);</span>
    <span class="k">return</span><span class="o">;</span>
  <span class="o">}</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>➜  freshjava java KeygenMe
Enter key:
picoCTF<span class="o">{</span>700l1ng_r3qu1r3d_126c59f0<span class="o">}</span>
Valid key
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{700l1ng_r3qu1r3d_126c59f0}</code></p><h2 id="bbbbloat">Bbbbloat<a href="#bbbbloat" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Reverse engineer this binary.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>➜  Bbbbloat ./bbbbloat 
What<span class="s1">'s my favorite number? 99
Sorry, that'</span>s not it!
</pre></table></code></div></div><p>Using r2 we can dynamically debug the program as below.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre><td class="rouge-code"><pre>➜  Bbbbloat r2 <span class="nt">-d</span> bbbbloat 
Process with PID 68182 started...
<span class="o">=</span> attach 68182 68182
bin.baddr 0x559726213000
Using 0x559726213000
asm.bits 64
Warning: r_bin_file_hash: file exceeds bin.hashlimit
 <span class="nt">--</span> Mind the trap.
<span class="o">[</span>0x7fac5c90e100]&gt; aaa
<span class="o">[</span>x] Analyze all flags starting with sym. and entry0 <span class="o">(</span>aa<span class="o">)</span>
<span class="o">[</span>x] Analyze <span class="k">function </span>calls <span class="o">(</span>aac<span class="o">)</span>
<span class="o">[</span>x] Analyze len bytes of instructions <span class="k">for </span>references <span class="o">(</span>aar<span class="o">)</span>
<span class="o">[</span>x] Check <span class="k">for </span>objc references
<span class="o">[</span>x] Check <span class="k">for </span>vtables
<span class="o">[</span>TOFIX: aaft can<span class="s1">'t run in debugger mode.ions (aaft)
[x] Type matching analysis for all functions (aaft)
[x] Propagate noreturn information
[x] Use -AA or aaaa to perform additional experimental analysis.
[0x7fac5c90e100]&gt; afll
address            size  nbbs edges    cc cost          min bound range max bound          calls locals args xref frame name
================== ==== ===== ===== ===== ==== ================== ===== ================== ===== ====== ==== ==== ===== ====
0x0000559726214160   46     1     0     1   15 0x0000559726214160    46 0x000055972621418e     1    0      1    0     8 entry0
0x0000559726216fe0 4121     1     0     1 2060 0x0000559726216fe0  4121 0x0000559726217ff9     0    0      0    1     0 reloc.__libc_start_main
0x00005597262140d0   11     1     0     1    4 0x00005597262140d0    11 0x00005597262140db     0    0      0    1     0 sym.imp.free
0x00005597262140e0   11     1     0     1    4 0x00005597262140e0    11 0x00005597262140eb     0    0      0    1     0 sym.imp.putchar
0x00005597262140f0   11     1     0     1    4 0x00005597262140f0    11 0x00005597262140fb     0    0      0    1     0 sym.imp.puts
0x0000559726214100   11     1     0     1    4 0x0000559726214100    11 0x000055972621410b     0    0      0    0     0 sym.imp.strlen
0x0000559726214110   11     1     0     1    4 0x0000559726214110    11 0x000055972621411b     0    0      0    1     0 sym.imp.__stack_chk_fail
0x0000559726214120   11     1     0     1    4 0x0000559726214120    11 0x000055972621412b     0    0      0    1     0 sym.imp.printf
0x0000559726214130   11     1     0     1    4 0x0000559726214130    11 0x000055972621413b     0    0      0    1     0 sym.imp.fputs
0x0000559726213000  341     3     2     3  158 0x0000559726213000   348 0x000055972621315c     0    0      2    0     0 loc.imp._ITM_deregisterTMCloneTable
0x0000559726214140   11     1     0     1    4 0x0000559726214140    11 0x000055972621414b     0    0      0    1     0 sym.imp.__isoc99_scanf
0x0000559726214150   11     1     0     1    4 0x0000559726214150    11 0x000055972621415b     0    0      0    0     0 sym.imp.strdup
0x0000559726214240   60     5     5     4   22 0x00005597262141c0   137 0x0000559726214249     0    0      0    0     0 entry.init0
0x0000559726214200   54     5     5     4   24 0x0000559726214200    57 0x0000559726214239     2    0      0    0     8 entry.fini0
0x00005597262140c0   11     1     0     1    4 0x00005597262140c0    11 0x00005597262140cb     0    0      0    1     0 fcn.5597262140c0
0x0000559726214190   34     4     4     4   14 0x0000559726214190    41 0x00005597262141b9     0    0      0    1     0 fcn.559726214190
0x0000559726214307  675     6     6     4  178 0x0000559726214307   675 0x00005597262145aa     8   10      2    1    88 main
[0x7fac5c90e100]&gt; db main
[0x7fac5c90e100]&gt; pdf@main
            ; DATA XREF from entry0 @ 0x559726214181
┌ 675: int main (int argc, char **argv, char **envp);
│           ; var int64_t var_50h @ rbp-0x50
│           ; var int64_t var_44h @ rbp-0x44
│           ; var int64_t var_40h @ rbp-0x40
│           ; var int64_t var_3ch @ rbp-0x3c
│           ; var int64_t var_38h @ rbp-0x38
│           ; var int64_t var_30h @ rbp-0x30
│           ; var int64_t var_28h @ rbp-0x28
│           ; var int64_t var_20h @ rbp-0x20
│           ; var int64_t var_18h @ rbp-0x18
│           ; var int64_t var_8h @ rbp-0x8
│           ; arg int argc @ rdi
│           ; arg char **argv @ rsi
│           0x559726214307 b    f30f1efa       endbr64
│           0x55972621430b      55             push rbp
│           0x55972621430c      4889e5         mov rbp, rsp
│           0x55972621430f      4883ec50       sub rsp, 0x50
│           0x559726214313      897dbc         mov dword [var_44h], edi ; argc
│           0x559726214316      488975b0       mov qword [var_50h], rsi ; argv
[0x7fac5c90e100]&gt; db 0x5597262144cb
[0x7fac5c90e100]&gt; dc
hit breakpoint at: 559726214307
[0x55972621430c]&gt; dc
What'</span>s my favorite number? 99
hit breakpoint at: 5597262144cb
<span class="o">[</span>0x5597262144cb]&gt; dr
rax <span class="o">=</span> 0x00000063
rbx <span class="o">=</span> 0x5597262145b0
rcx <span class="o">=</span> 0x00000000
rdx <span class="o">=</span> 0x000d2c49
r8 <span class="o">=</span> 0x0000000a
r9 <span class="o">=</span> 0x00000000
r10 <span class="o">=</span> 0x7fac5c892ac0
r11 <span class="o">=</span> 0x00000000
r12 <span class="o">=</span> 0x559726214160
r13 <span class="o">=</span> 0x7ffec33e00b0
r14 <span class="o">=</span> 0x00000000
r15 <span class="o">=</span> 0x00000000
rsi <span class="o">=</span> 0x000d2c49
rdi <span class="o">=</span> 0x000d2c49
rsp <span class="o">=</span> 0x7ffec33dff70
rbp <span class="o">=</span> 0x7ffec33dffc0
rip <span class="o">=</span> 0x5597262144cb
rflags <span class="o">=</span> 0x00000202
orax <span class="o">=</span> 0xffffffffffffffff
<span class="o">[</span>0x5597262144cb]&gt; dr <span class="nv">rax</span><span class="o">=</span>0x86187
0x00000063 -&gt;0x00086187
<span class="o">[</span>0x5597262144cb]&gt; dc
picoCTF<span class="o">{</span>cu7_7h3_bl047_2d7aeca1<span class="o">}</span>
<span class="o">[</span>0x7fac5c7da176]&gt; 
<span class="o">[</span>0x7fac5c7da176]&gt; dc
child exited with status 0

<span class="o">==&gt;</span> Process finished
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{cu7_7h3_bl047_2d7aeca1}</code></p><h2 id="unpackme">unpackme<a href="#unpackme" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you get the flag? Reverse engineer this binary.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>➜  unpackeme file unpackme-upx 
unpackme-upx: ELF 64-bit LSB executable, x86-64, version 1 <span class="o">(</span>GNU/Linux<span class="o">)</span>, statically linked, no section header
➜  unpackeme upx <span class="nt">-d</span> unpackme-upx <span class="nt">-o</span> unpackme
                       Ultimate Packer <span class="k">for </span>eXecutables
                          Copyright <span class="o">(</span>C<span class="o">)</span> 1996 - 2020
UPX 3.96        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Jan 23rd 2020

        File size         Ratio      Format      Name
   <span class="nt">--------------------</span>   <span class="nt">------</span>   <span class="nt">-----------</span>   <span class="nt">-----------</span>
   1002408 &lt;-    379116   37.82%   linux/amd64   unpackme

Unpacked 1 file.
➜  unpackeme ./unpackme 
What<span class="s1">'s my favorite number? 223
Sorry, that'</span>s not it!
</pre></table></code></div></div><p>Alright time to reverse engineer the binary after unpacking.</p><p><img data-src="https://bn1304files.storage.live.com/y4mV4EySxpD-ds-sjaeXk5i7UL8kUKLKU5kj-KHs4IYUJiE1LVyZ2y4eVEXSbqqv3MWKaYMl39K25djJPfnWHiiQz4J-EIx6TFC7eHIyOQV_SW71CRO7UaF1WSf9TRPQoNoZ5sjDY5bUMZasXy6uasqe85qFOtrIJzxM8BMYXSidbd9yuf_Tz1ZRQhO5fK8Rifl?width=2860&amp;height=1732&amp;cropmode=none" alt="1" data-proofer-ignore></p><p><img data-src="https://bn1304files.storage.live.com/y4mYJs-y-nePNiqnLFlhAMQblEs-bf8Mehff9d2zpr3Yh_gXkLBvAl6VA6keEq7J8GmQGD02noZvJO1NSrC_77-tq6lvLxR9EtJYYPkZkEcF03iy7rE-aKN5Bk1T56K-keshlUQPnUrMbJG_5s0DvttgZcc5yTeZFUXSMD4VgZVEf6Wukqi05n2UCOjwW-xTKFD?width=2860&amp;height=1732&amp;cropmode=none" alt="2" data-proofer-ignore></p><p><img data-src="https://bn1304files.storage.live.com/y4m1-HwKOFSnekV_Wl6inu0UFBiHgzQbLFFlwnl5bAw9Cf7CdRvyPkiExaxjdRZhmX31ycGo883WClg46hcot-TExh-IoMeNoCBzkD5rhEyqQII6cuoduwFsI7KNT6OJMmu7Mcq5sN8C4WnV5UJDoPQTr4uf2zXI7bjfj7zqtYft6E1dXxs5rTx_xY9Tf2Zn0ku?width=2860&amp;height=1732&amp;cropmode=none" alt="3" data-proofer-ignore></p><p><img data-src="https://bn1304files.storage.live.com/y4mlFbsKUi5n1UP_6GC2lODp7EIgQBzBwk0XVE00BG9fMG5a19W7figOyg_IuB15uow4Su_mF0F_szEBnBI9w93anhLNmyla0afKfYsxinkh9KgxOLtSWBkCBJ2aPJnf_yX_MipfVu8bJPvNbM706Z9LCvcm3B0qUAk-o_8hgFHQCkwe_3GxsTdVFkPIZWhZW9I?width=2860&amp;height=1732&amp;cropmode=none" alt="4" data-proofer-ignore></p><p><img data-src="https://bn1304files.storage.live.com/y4mw_7Nt7F_A2fnhkpncLXdA_9flXeC98_zBYCj0-OxIQlniu4tRUmNwMF3k-HAZlq0j7xQAHaZQZYtTHkDLOgNmRO_KgipawT_4OLW6WG6G4LjBE9U-WWYCc_gwmLmBUOloBeG4JeDFWN-XGpSj7evMQ7xb276s0bETRezArkj0-AMrc2jZkG9KtIHppvOYhMi?width=2860&amp;height=1732&amp;cropmode=none" alt="5" data-proofer-ignore></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre>➜  unpackeme gdb unpackme
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">set </span>disassembly-flavor intel
<span class="o">(</span>gdb<span class="o">)</span> disassemble main
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">break </span>main
Breakpoint 1 at 0x401e73
<span class="o">(</span>gdb<span class="o">)</span> <span class="nb">break</span> <span class="k">*</span><span class="o">(</span>main+133<span class="o">)</span>
Breakpoint 2 at 0x401ef8
<span class="o">(</span>gdb<span class="o">)</span> run
Starting program: /cases/pico2022/revEngineer/unpackeme/unpackme

Breakpoint 1, 0x0000000000401e73 <span class="k">in </span>main <span class="o">()</span>
<span class="o">(</span>gdb<span class="o">)</span> <span class="k">continue
</span>Continuing.
What<span class="s1">'s my favorite number? 99
Breakpoint 2, 0x0000000000401ef8 in main ()
rax            0x63                99
rbx            0x400530            4195632
rcx            0x0                 0
rdx            0x0                 0
rsi            0x0                 0
rdi            0x7fffffffd930      140737488345392
rbp            0x7fffffffdec0      0x7fffffffdec0
rsp            0x7fffffffde70      0x7fffffffde70
r8             0xa                 10
r9             0x0                 0
r10            0x4ba400            4957184
r11            0x0                 0
r12            0x402ff0            4206576
r13            0x0                 0
--Type &lt;RET&gt; for more, q to quit, c to continue without paging--
(gdb) set $eax=0xb83cb 
rax            0xb83cb             754635
rbx            0x400530            4195632
rcx            0x0                 0
rdx            0x0                 0
rsi            0x0                 0
rdi            0x7fffffffd930      140737488345392
rbp            0x7fffffffdec0      0x7fffffffdec0
rsp            0x7fffffffde70      0x7fffffffde70
r8             0xa                 10
r9             0x0                 0
r10            0x4ba400            4957184
r11            0x0                 0
r12            0x402ff0            4206576
r13            0x0                 0
--Type &lt;RET&gt; for more, q to quit, c to continue without paging--
(gdb) ni
0x0000000000401efd in main ()
0x0000000000401eff in main ()
(gdb) continue
Continuing.
picoCTF{up&gt;&lt;_m3_f7w_ed7b0850}
[Inferior 1 (process 67587) exited normally]
</span></pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{up&gt;&lt;_m3_f7w_ed7b0850}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/reverse-engineering/'>Reverse-Engineering</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >Reverse-Engineering</a> <a href="/tags/picoctf-2022/" class="post-tag no-text-decoration" >picoctf-2022</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Pico CTF 2022: Reverse-Engineering 🛠 💾 - (B)rootware Research&url=https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Pico CTF 2022: Reverse-Engineering 🛠 💾 - (B)rootware Research&u=https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/&text=Pico CTF 2022: Reverse-Engineering 🛠 💾 - (B)rootware Research" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://brootware.github.io/posts/pico-ctf-2022-reverse-engineering/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/sensitive-data-redaction-pyredactkit/">Sensitive data redaction/unredaction tool - PyRedactKit 🧰🔐📝</a><li><a href="/posts/regex-performance-in-golang-and-rust-which-is-faster/">Regex performance in golang and rust. Which is faster? 🤔</a><li><a href="/posts/cyber-security-education/">Cyber Security Education 🔐 🕵️ 🎓</a><li><a href="/posts/cyber-league-ctf-2022-writeups/">Cyber League CTF 2022 - Writeups 🚩</a><li><a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/">Grepping for gold in JSON APIs with jq 🔍 📄</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/picomini22pwcrack5/"><div class="card-body"> <em class="timeago small" date="2022-01-15 10:22:00 +0800" >Jan 15, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Beginner picoMini 2022 password crack 5 🚩</h3><div class="text-muted small"><p> Point: 100 Category Cryptography, Reverse-Engineering Question Can you crack the password to get the flag? Download the password checker here and you’ll need the encrypted flag and the hash i...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-web-exploitation/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:27:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Web-exploitation 🏁 🕸 👨🏻‍💻</h3><div class="text-muted small"><p> Local Authority Can you get the flag? Go to this website and see what you can discover. Flag : picoCTF{j5_15_7r4n5p4r3n7_6309e949} First we tried to login using random username and password to g...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-forensics/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:31:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Forensics 🕵️ 🏁</h3><div class="text-muted small"><p> Enhance Download this image file and find the flag. 1 2 strings drawing.flag.svg picoCTF{3nh4nc3d_58bd3420} Flag : picoCTF{3nh4nc3d_58bd3420} Lookey here Attackers have hidden information in ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/cyber-security-education/" class="btn btn-outline-primary" prompt="Older"><p>Cyber Security Education 🔐 🕵️ 🎓</p></a> <a href="/posts/pico-ctf-2022-web-exploitation/" class="btn btn-outline-primary" prompt="Newer"><p>Pico CTF 2022: Web-exploitation 🏁 🕸 👨🏻‍💻</p></a></div><script src="https://utteranc.es/client.js" repo="brootware/brootware.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/brootware">Oaker Min (Bruce)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E65Q2J8381"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E65Q2J8381'); }); </script>
