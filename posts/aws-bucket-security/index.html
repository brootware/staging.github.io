<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê" /><meta property="og:locale" content="en" /><meta name="description" content="Point: 600" /><meta property="og:description" content="Point: 600" /><link rel="canonical" href="https://brootware.github.io/posts/aws-bucket-security/" /><meta property="og:url" content="https://brootware.github.io/posts/aws-bucket-security/" /><meta property="og:site_name" content="(B)rootware Research" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-05T17:16:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê" /><meta name="twitter:site" content="@brootware" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-03-05T07:54:30+08:00","datePublished":"2022-02-05T17:16:00+08:00","description":"Point: 600","mainEntityOfPage":{"@type":"WebPage","@id":"https://brootware.github.io/posts/aws-bucket-security/"},"url":"https://brootware.github.io/posts/aws-bucket-security/","@type":"BlogPosting","headline":"AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê","@context":"https://schema.org"}</script><title>AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê | (B)rootware Research</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="(B)rootware Research"><meta name="application-name" content="(B)rootware Research"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7734956?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">(B)rootware Research</a></div><div class="site-subtitle font-italic">Cloud DevOps / Site Reliability Engineering, Cyber Security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/brootware" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/brootware" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/oakermin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/brootware">Oaker Min (Bruce)</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-05 17:16:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Sat, Feb 5, 2022, 5:16 PM +0800" >Feb 5, 2022</em> </span> <span> Updated <em class="timeago" date="2022-03-05 07:54:30 +0800 " data-toggle="tooltip" data-placement="bottom" title="Sat, Mar 5, 2022, 7:54 AM +0800" >Mar 5, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="595 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>Point: 600</p><p><a href="https://cyberdefenders.org/blueteam-ctf-challenges/progress/rootware/84/"><img data-src="https://img.shields.io/badge/completed-aws%20cloud%20security-brightgreen.svg" data-proofer-ignore></a></p><h2 id="category">Category<a href="#category" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Cloud Security, Blue team, Incident Response</p><h2 id="challenge-details">Challenge Details<a href="#challenge-details" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Welcome, Defender! As an incident responder, we‚Äôre granting you access to the AWS account called ‚ÄúSecurity‚Äù as an IAM user. This account contains a copy of the logs during the time period of the incident and has the ability to assume the ‚ÄúSecurity‚Äù role in the target account so you can look around to spot the misconfigurations that allowed for this attack to happen.</p><p>Credentials<br /> Your IAM credentials for the Security account:</p><ul><li>Login: <a href="https://flaws2-security.signin.aws.amazon.com/console">https://flaws2-security.signin.aws.amazon.com/console</a><li>Account ID: 322079859186<li>Username: security<li>Password: password<li>Access Key: AKIAIUFNQ2WCOPTEITJQ<li>Secret Key: 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</ul><p>Environment The credentials above give you access to the Security account, which can assume the role of ‚Äúsecurity‚Äù in the Target account. You also have access to an S3 bucket, named flaws2_logs, in the Security account, that contains the CloudTrail logs recorded during a successful compromise</p><h2 id="solution">Solution<a href="#solution" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="what-is-the-full-aws-cli-command-used-to-configure-credentials">What is the full AWS CLI command used to configure credentials?<a href="#what-is-the-full-aws-cli-command-used-to-configure-credentials" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>aws configure</p><h3 id="what-is-the-creation-date-of-the-bucket-flaws2-logs">What is the ‚Äòcreation‚Äô date of the bucket ‚Äòflaws2-logs‚Äô?<a href="#what-is-the-creation-date-of-the-bucket-flaws2-logs" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>
aws s3api list-buckets
<span class="o">{</span>
    <span class="s2">"Buckets"</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">"Name"</span>: <span class="s2">"flaws2-logs"</span>,
            <span class="s2">"CreationDate"</span>: <span class="s2">"2018-11-19T20:54:31+00:00"</span>
        <span class="o">}</span>
    <span class="o">]</span>,
    <span class="s2">"Owner"</span>: <span class="o">{</span>
        <span class="s2">"DisplayName"</span>: <span class="s2">"scott+flaws2_security"</span>,
        <span class="s2">"ID"</span>: <span class="s2">"0ff467deaf461e549934997a2df02d29c8010173b1464262782d522bce63bf46"</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>The answer to the question is as below date-time format. 2018-11-19 20:54:31 UTC</p><h3 id="what-is-the-name-of-the-first-generated-event--according-to-time">What is the name of the first generated event -according to time?<a href="#what-is-the-name-of-the-first-generated-event--according-to-time" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>
aws s3 <span class="nb">cp </span>s3://flaws2-logs/AWSLogs/653711331788/CloudTrail/us-east-1/2018/11/28/653711331788_CloudTrail_us-east-1_20181128T2235Z_cR9ra7OH1rytWyXY.json.gz <span class="nb">.</span> <span class="nt">--no-sign-request</span>

<span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2235Z_cR9ra7OH1rytWyXY.json | jq <span class="s1">'.Records[0].eventName'</span>
<span class="s2">"AssumeRole"</span>
</pre></table></code></div></div><h3 id="what-source-ip-address-generated-the-event-dated-2018-11-28-at-230320-utc">What source IP address generated the event dated 2018-11-28 at 23:03:20 UTC?<a href="#what-source-ip-address-generated-the-event-dated-2018-11-28-at-230320-utc" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
<span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2305Z_83VTWZ8Z0kiEC7Lq.json | jq <span class="s1">'.Records[0].sourceIPAddress'</span>
<span class="s2">"34.234.236.212"</span>

</pre></table></code></div></div><h3 id="which-ip-address-does-not-belong-to-amazon-aws-infrastructure">Which IP address does not belong to Amazon AWS infrastructure?<a href="#which-ip-address-does-not-belong-to-amazon-aws-infrastructure" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>
<span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2305Z_zKlMhON7EpHala9u.json | jq <span class="s1">'.Records[0]'</span>
<span class="o">{</span>
  <span class="s2">"eventVersion"</span>: <span class="s2">"1.05"</span>,
  <span class="s2">"userIdentity"</span>: <span class="o">{</span>
    <span class="s2">"type"</span>: <span class="s2">"AWSAccount"</span>,
    <span class="s2">"principalId"</span>: <span class="s2">""</span>,
    <span class="s2">"accountId"</span>: <span class="s2">"ANONYMOUS_PRINCIPAL"</span>
  <span class="o">}</span>,
  <span class="s2">"eventTime"</span>: <span class="s2">"2018-11-28T23:02:56Z"</span>,
  <span class="s2">"eventSource"</span>: <span class="s2">"s3.amazonaws.com"</span>,
  <span class="s2">"eventName"</span>: <span class="s2">"GetObject"</span>,
  <span class="s2">"awsRegion"</span>: <span class="s2">"us-east-1"</span>,
  <span class="s2">"sourceIPAddress"</span>: <span class="s2">"104.102.221.250"</span>,
  <span class="s2">"userAgent"</span>: <span class="s2">"[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36]"</span>,
  <span class="s2">"requestParameters"</span>: <span class="o">{</span>
    <span class="s2">"bucketName"</span>: <span class="s2">"flaws2.cloud"</span>,
    <span class="s2">"key"</span>: <span class="s2">"index.htm"</span>
  <span class="o">}</span>,
  <span class="s2">"responseElements"</span>: null,
  <span class="s2">"additionalEventData"</span>: <span class="o">{</span>
    <span class="s2">"x-amz-id-2"</span>: <span class="s2">"E/0Pm6UrRvpvNEYDjXhDnCsudplsm91YXPM5ShG/caAJ8H/adUjxO4fTIWRNKLwkVB9G6zEszOI="</span>
  <span class="o">}</span>,
  <span class="s2">"requestID"</span>: <span class="s2">"D9DB3DE51407FFEC"</span>,
  <span class="s2">"eventID"</span>: <span class="s2">"38993e7c-b9e9-46eb-9f93-82e710147d39"</span>,
  <span class="s2">"readOnly"</span>: <span class="nb">true</span>,
  <span class="s2">"resources"</span>: <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"type"</span>: <span class="s2">"AWS::S3::Object"</span>,
      <span class="s2">"ARN"</span>: <span class="s2">"arn:aws:s3:::flaws2.cloud/index.htm"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"accountId"</span>: <span class="s2">"653711331788"</span>,
      <span class="s2">"type"</span>: <span class="s2">"AWS::S3::Bucket"</span>,
      <span class="s2">"ARN"</span>: <span class="s2">"arn:aws:s3:::flaws2.cloud"</span>
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">"eventType"</span>: <span class="s2">"AwsApiCall"</span>,
  <span class="s2">"recipientAccountId"</span>: <span class="s2">"653711331788"</span>,
  <span class="s2">"sharedEventID"</span>: <span class="s2">"9deca33a-d705-42ef-b425-cafe63c5011c"</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Narrowing down the answer further as below.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
<span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2305Z_zKlMhON7EpHala9u.json | jq <span class="s1">'.Records[0].sourceIPAddress'</span>
<span class="s2">"104.102.221.250"</span>
</pre></table></code></div></div><h3 id="which-user-issued-the-listbuckets-request">Which user issued the ‚ÄòListBuckets‚Äô request?<a href="#which-user-issued-the-listbuckets-request" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2310Z_jQajCuiobojD8I4y.json | jq <span class="s1">'.Records[0]'</span>
<span class="o">{</span>
  <span class="s2">"eventVersion"</span>: <span class="s2">"1.05"</span>,
  <span class="s2">"userIdentity"</span>: <span class="o">{</span>
    <span class="s2">"type"</span>: <span class="s2">"AssumedRole"</span>,
    <span class="s2">"principalId"</span>: <span class="s2">"AROAJQMBDNUMIKLZKMF64:d190d14a-2404-45d6-9113-4eda22d7f2c7"</span>,
    <span class="s2">"arn"</span>: <span class="s2">"arn:aws:sts::653711331788:assumed-role/level3/d190d14a-2404-45d6-9113-4eda22d7f2c7"</span>,
    <span class="s2">"accountId"</span>: <span class="s2">"653711331788"</span>,
    <span class="s2">"accessKeyId"</span>: <span class="s2">"ASIAZQNB3KHGNXWXBSJS"</span>,
    <span class="s2">"sessionContext"</span>: <span class="o">{</span>
      <span class="s2">"attributes"</span>: <span class="o">{</span>
        <span class="s2">"mfaAuthenticated"</span>: <span class="s2">"false"</span>,
        <span class="s2">"creationDate"</span>: <span class="s2">"2018-11-28T22:31:59Z"</span>
      <span class="o">}</span>,
      <span class="s2">"sessionIssuer"</span>: <span class="o">{</span>
        <span class="s2">"type"</span>: <span class="s2">"Role"</span>,
        <span class="s2">"principalId"</span>: <span class="s2">"AROAJQMBDNUMIKLZKMF64"</span>,
        <span class="s2">"arn"</span>: <span class="s2">"arn:aws:iam::653711331788:role/level3"</span>,
        <span class="s2">"accountId"</span>: <span class="s2">"653711331788"</span>,
        <span class="s2">"userName"</span>: <span class="s2">"level3"</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>,
  <span class="s2">"eventTime"</span>: <span class="s2">"2018-11-28T23:09:28Z"</span>,
  <span class="s2">"eventSource"</span>: <span class="s2">"s3.amazonaws.com"</span>,
  <span class="s2">"eventName"</span>: <span class="s2">"ListBuckets"</span>,
  <span class="s2">"awsRegion"</span>: <span class="s2">"us-east-1"</span>,
  <span class="s2">"sourceIPAddress"</span>: <span class="s2">"104.102.221.250"</span>,
  <span class="s2">"userAgent"</span>: <span class="s2">"[aws-cli/1.16.19 Python/2.7.10 Darwin/17.7.0 botocore/1.12.9]"</span>,
  <span class="s2">"requestParameters"</span>: null,
  <span class="s2">"responseElements"</span>: null,
  <span class="s2">"requestID"</span>: <span class="s2">"4698593B9338B27F"</span>,
  <span class="s2">"eventID"</span>: <span class="s2">"65e111a0-83ae-4ba8-9673-16291a804873"</span>,
  <span class="s2">"eventType"</span>: <span class="s2">"AwsApiCall"</span>,
  <span class="s2">"recipientAccountId"</span>: <span class="s2">"653711331788"</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Narrowing down the answer to username as below</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>
<span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2310Z_jQajCuiobojD8I4y.json | jq <span class="s1">'.Records[0].userIdentity.sessionContext.sessionIssuer.userName'</span>
<span class="s2">"level3"</span>

</pre></table></code></div></div><h3 id="what-was-the-first-request-issued-by-the-user-level1">What was the first request issued by the user ‚Äòlevel1‚Äô?<a href="#what-was-the-first-request-issued-by-the-user-level1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cat </span>653711331788_CloudTrail_us-east-1_20181128T2310Z_7J9NEIxrjJsrlXSd.json | jq <span class="s1">'.Records[0].eventName'</span>
<span class="s2">"CreateLogStream"</span>
</pre></table></code></div></div><h2 id="improvement">Improvement<a href="#improvement" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>None</p><h2 id="for-more-writeups">For more writeups<a href="#for-more-writeups" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This write up is featured as just one of many write-ups that has been written. For more writeups please visit this <a href="https://github.com/brootware/CTF-Writeups">repo</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/cloud-security/'>Cloud-Security</a>, <a href='/categories/incident-response/'>Incident-Response</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/cloud-security/" class="post-tag no-text-decoration" >Cloud-Security</a> <a href="/tags/incident-response/" class="post-tag no-text-decoration" >Incident-Response</a> <a href="/tags/blue-team/" class="post-tag no-text-decoration" >Blue-team</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê - (B)rootware Research&url=https://brootware.github.io/posts/aws-bucket-security/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê - (B)rootware Research&u=https://brootware.github.io/posts/aws-bucket-security/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brootware.github.io/posts/aws-bucket-security/&text=AWS Bucket - Cloud Security ‚òÅÔ∏è ü™£ üîê - (B)rootware Research" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://brootware.github.io/posts/aws-bucket-security/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/sensitive-data-redaction-pyredactkit/">Sensitive data redaction/unredaction tool - PyRedactKit üß∞üîêüìù</a><li><a href="/posts/regex-performance-in-golang-and-rust-which-is-faster/">Regex performance in golang and rust. Which is faster? ü§î</a><li><a href="/posts/cyber-security-education/">Cyber Security Education üîê üïµÔ∏è üéì</a><li><a href="/posts/cyber-league-ctf-2022-writeups/">Cyber League CTF 2022 - Writeups üö©</a><li><a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/">Grepping for gold in JSON APIs with jq üîç üìÑ</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/malware-traffic-analysis-1/"><div class="card-body"> <em class="timeago small" date="2022-03-07 18:51:00 +0800" >Mar 7, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Malware Traffic Analysis-1 üëæüíª‚ò†Ô∏è</h3><div class="text-muted small"><p> Point: 950 Category Forensics Challenge Details The attached PCAP belongs to an Exploitation Kit infection. Analyze it using your favorite tool and answer the challenge questions. Solution ...</p></div></div></a></div><div class="card"> <a href="/posts/exploiting-kubernetes-through-a-grafana-lfi-vulnerability/"><div class="card-body"> <em class="timeago small" date="2022-02-25 11:49:00 +0800" >Feb 25, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Exploiting Kubernetes through a Grafana LFI vulnerability üë®‚Äçüî¨üîéüíâ</h3><div class="text-muted small"><p> Category Cloud-Security, Kubernetes Security, LFI vulnerability Introduction Securing kubernetes cluster is a monumental task. There are a lot of things that needs to be considered for properl...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-forensics/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:31:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Forensics üïµÔ∏è üèÅ</h3><div class="text-muted small"><p> Enhance Download this image file and find the flag. 1 2 strings drawing.flag.svg picoCTF{3nh4nc3d_58bd3420} Flag : picoCTF{3nh4nc3d_58bd3420} Lookey here Attackers have hidden information in ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/picomini22pwcrack5/" class="btn btn-outline-primary" prompt="Older"><p>Beginner picoMini 2022 password crack 5 üö©</p></a> <a href="/posts/automating-kali-toolkit-installation/" class="btn btn-outline-primary" prompt="Newer"><p>Automating kali toolkit installation üß∞</p></a></div><script src="https://utteranc.es/client.js" repo="brootware/brootware.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2023 <a href="https://github.com/brootware">Oaker Min (Bruce)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E65Q2J8381"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E65Q2J8381'); }); </script>
