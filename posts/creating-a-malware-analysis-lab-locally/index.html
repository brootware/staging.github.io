<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨" /><meta property="og:locale" content="en" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/" /><meta property="og:url" content="https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/" /><meta property="og:site_name" content="(B)rootware Research" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-21T14:11:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨" /><meta name="twitter:site" content="@brootware" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-03-04T18:57:11+08:00","datePublished":"2022-02-21T14:11:00+08:00","description":"Introduction","mainEntityOfPage":{"@type":"WebPage","@id":"https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/"},"url":"https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/","@type":"BlogPosting","headline":"Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨","@context":"https://schema.org"}</script><title>Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨ | (B)rootware Research</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="(B)rootware Research"><meta name="application-name" content="(B)rootware Research"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7734956?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">(B)rootware Research</a></div><div class="site-subtitle font-italic">Cloud DevOps / Site Reliability Engineering, Cyber Security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/brootware" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/brootware" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/oakermin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/brootware">Oaker Min (Bruce)</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-21 14:11:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 21, 2022, 2:11 PM +0800" >Feb 21, 2022</em> </span> <span> Updated <em class="timeago" date="2022-03-04 18:57:11 +0800 " data-toggle="tooltip" data-placement="bottom" title="Fri, Mar 4, 2022, 6:57 PM +0800" >Mar 4, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="820 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h2 id="introduction">Introduction<a href="#introduction" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>As I was doing a CTF based on <a href="https://brootware.github.io/posts/detecting-and-defending-against-log4j-attacks/">detecting log4j attacks with ransomware khonsari</a> recently I came across a lot of the hurdles of setting up forensic tools like Autopsy, pdfid, dotNet based debuggers and reverse engineering tools to solve the challenges.</p><blockquote><p>TLDR, I just want the quick VM for my CTF!! Go there -&gt; <a href="https://github.com/brootware/flarevm-up">https://github.com/brootware/flarevm-up</a></p></blockquote><p>This took a lot of time! More than a day perhaps to troubleshoot, look around for articles on how to set up on windows as I am currently using a mac. At first, I tried to use Autopsy on mac but the features were severely lacking as the software is exposed via a web browser on localhost.</p><p><img data-src="https://bn1304files.storage.live.com/y4m_mTBjk8we9Ns3HHA3io3A1OfXogPTjOJgy-Ao3kL8dQPFFCp-s8c0gCEiwCJ4OJb5T4h8MNLVOeyB2N3QMgR6Wv3Wxe82uPv8iqQsZhAI7ASxyZDNWiWt4Umx2f96qoJcgntptdKDVbuvsA_ZPLvRZiVlOTwpYPMaaInZyJqER6dtxJS2J8r_ZsvjI5NQcUu?width=2496&amp;height=1528&amp;cropmode=none" alt="features" data-proofer-ignore></p><p>There has to be a better way to solve this and gotta be ready the next time I do such blue team CTF. So basically the very manual and time consuming steps are:</p><ol><li>Setup windows VM (either locally with VirtualBox or in the cloud with Azure. More on setting up in the cloud in part 2 of this)<li>Read the documentation on installing each tool needed for malware analysis<li>Install each tool<li>Troubleshoot during the installation. Repeat.</ol><h2 id="enter-flare-vm-by-mandiant">Enter flare-vm by mandiant<a href="#enter-flare-vm-by-mandiant" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 300'%3E%3C/svg%3E" width="300" height="300" data-src="https://raw.githubusercontent.com/mandiant/flare-vm/master/flarevm.png?raw=true" alt="FLARE VM" data-proofer-ignore></p><p><a href="https://github.com/mandiant/flare-vm">flareVM</a> is a PowerShell install script created by mandiant. The tool itself is pretty great. But setting up a sandbox VM locally and installing the tool takes a lot of time! (4-5 hours, trust me I timed this). The nature of malware analysis also requires you to dispose of the VM and have a fresh re-install whenever it is needed. If you have multiple devices or just want to have a fresh re-install after a malware analysis lab, going through that would waste a lot of time. So here are the three main points to recap:</p><ul><li>Spin up a fresh VM as and when it is needed.<li>Have a consistent setup on multiple devices.<li>Lesser time spent on setting up the sandbox VM.</ul><p>The goal here is to make it easy to spin up a machine in an automated manner. To achieve this, I used Vagrant and Virtualbox. I imaged the installed VM using Vagrant CLI and VirtualBox to upload the box to vagrant cloud for easier distribution. This also allows users to easily spin up the lab VMs consistently across multiple devices.</p><p><img data-src="https://bn1304files.storage.live.com/y4mpDQXUoXXDYi0d0txMljIayd944IrihlWhPZejG2QsD1qConiEObDdUmAgU_Od1Ihx3Gfj7rDKdCC_ct0xmzNRIuQJ_0lFSBWikYWChYH0Pio9pXUGcCKQWjkPILVNGKixpYKOAxGqNDzmX__ZVVK0uO-oS-6KFCH_S42h1UPcRA3Ev_-R6A_5X3ZxxjeBuX-?width=1842&amp;height=1506&amp;cropmode=none" alt="flare2" data-proofer-ignore></p><h2 id="imaging-the-flare-vm-for-consistency-and-distribution">Imaging the Flare-VM for consistency and distribution<a href="#imaging-the-flare-vm-for-consistency-and-distribution" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is the most tedious part of making this project. Before starting, make sure your local device have enough space (more than 60GB) for this imaging process else you will run into errors. Do note that I will not be going into much details as most of these steps can be easily googled. Below are the steps</p><ul><li>A fresh windows 10 VM has to be installed from an ISO image downloaded from the Microsoft website.<li>Disable real-time protection<li>Disable cloud-delivered protection<li>Disable automatic sample submission<li>Add the directory C:\ to the exclusion list<li>Once the fresh VM is installed in VirtualBox, the flare-vm install script is run as below.</ul><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">wget</span><span class="w"> </span><span class="nx">https://raw.githubusercontent.com/mandiant/flare-vm/master/install.ps1</span><span class="w"> </span><span class="nt">-outfile</span><span class="w"> </span><span class="nx">install.ps1</span><span class="w">
</span><span class="n">Unblock-File</span><span class="w"> </span><span class="o">.</span><span class="nx">\install.ps1</span><span class="w">
</span><span class="n">Set-ExecutionPolicy</span><span class="w"> </span><span class="nx">Unrestricted</span><span class="w">
</span><span class="o">.</span><span class="n">\install.ps1</span><span class="w">
</span></pre></table></code></div></div><ul><li>After about 4-5 hours, the VM is ready to be imaged using Vagrant.<li>As this is a Windows VM, there are some pre-requisite configurations needed to be done. The detailed steps are documented on Vagrant website. <a href="https://www.vagrantup.com/docs/boxes/base#base-windows-configuration">https://www.vagrantup.com/docs/boxes/base#base-windows-configuration</a><li>Once base windows configuration is done, virtual box guest additions must be installed.<li>We are ready to package the box. Using the Vagrant CLI below where <code class="language-plaintext highlighter-rouge">my-vm</code> is the VM name given in VirtualBox. <strong>Make sure your device has enough space for the package</strong>. (I was stuck here for hours before I come across a blog to resolve.)</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>vagrant package <span class="nt">--base</span> my-vm <span class="nt">--output</span> flareVm.box
</pre></table></code></div></div><ul><li>This will take about an hour. The process will output a <code class="language-plaintext highlighter-rouge">flareVm.box</code> file that can be uploaded to Vagrant cloud.</ul><h2 id="uploading-to-vagrant-cloud">Uploading to Vagrant cloud<a href="#uploading-to-vagrant-cloud" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Uploading to Vagrant cloud is a fairly simple process. I followed the <a href="https://blog.ycshao.com/2017/09/16/how-to-upload-vagrant-box-to-vagrant-cloud/">blog here</a> to upload and publish the flareVm box. You can find the uploaded flareVm box at <a href="https://app.vagrantup.com/rootware/boxes/flareVm">https://app.vagrantup.com/rootware/boxes/flareVm</a>.</p><h2 id="how-to-spin-up-flare-vms-locally">How to spin up flare-vms locally<a href="#how-to-spin-up-flare-vms-locally" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>To make it much much easier, I created a GitHub repository with recommended Vagrantfile configurations to easily spin up the flare-vm with one line.</p><p><img data-src="https://bn1304files.storage.live.com/y4mzChhFPUZzWw51VpBYImq4RPZjCAiIV4w3aZ4Eu7fAaIwrsiznWEtXAXMcJg5iWMTOgjEX9SKBKxG6ON5oT-mg0G3-rTfZeaiDGSTBRMNcyMLR7Xe1RkRA7n00jALAnjjME3IbSzO80ogncVmJX3oMLiKv3P4movjcNBnMwtjabklZZM-tjz0zsyE4Kpu0A17?width=1842&amp;height=1506&amp;cropmode=none" alt="vagrant" data-proofer-ignore></p><p>You can find the repository at <a href="https://github.com/brootware/flarevm-up">https://github.com/brootware/flarevm-up</a>.</p><p>Make sure you have <a href="https://www.vagrantup.com/downloads">vagrant</a> and <a href="https://www.virtualbox.org/wiki/Downloads">virtualbox</a> installed on your device.</p><p>Run the below commands and let vagrant and VirtualBox do their magic!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>git clone https://github.com/brootware/flarevm-up.git <span class="o">&amp;&amp;</span> <span class="nb">cd </span>flarevm-up
vagrant up
</pre></table></code></div></div><h2 id="conclusion">Conclusion<a href="#conclusion" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This concludes the part 1 of creating a malware analysis lab locally on your device without incurring additional cost. In part 2 of this I will be going through the process of imaging it in Azure using Azure‚Äôs native image builder capability and sharing the image via azure compute gallery. This approach allows you to have the flexibility of using the sandboxed cloud VM for labs. You can read part 2 here <a href="https://brootware.github.io/posts/creating-a-malware-analysis-lab-in-the-cloud/">https://brootware.github.io/posts/creating-a-malware-analysis-lab-in-the-cloud/</a>.</p><p>Some great sources I used to build the box.</p><ul><li><a href="https://www.vagrantup.com/docs/boxes/base">https://www.vagrantup.com/docs/boxes/base</a><li><a href="https://www.vagrantup.com/docs/providers/virtualbox/boxes">https://www.vagrantup.com/docs/providers/virtualbox/boxes</a><li><a href="https://coder-question.com/cq-blog/1534">https://coder-question.com/cq-blog/1534</a><li><a href="https://blog.ycshao.com/2017/09/16/how-to-upload-vagrant-box-to-vagrant-cloud/">https://blog.ycshao.com/2017/09/16/how-to-upload-vagrant-box-to-vagrant-cloud/</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/projects/'>Projects</a>, <a href='/categories/security-toolkit/'>security-toolkit</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/projects/" class="post-tag no-text-decoration" >Projects</a> <a href="/tags/security-toolkit/" class="post-tag no-text-decoration" >security-toolkit</a> <a href="/tags/vagrant/" class="post-tag no-text-decoration" >vagrant</a> <a href="/tags/forensics/" class="post-tag no-text-decoration" >Forensics</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >Automation</a> <a href="/tags/devops/" class="post-tag no-text-decoration" >DevOps</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨ - (B)rootware Research&url=https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨ - (B)rootware Research&u=https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/&text=Creating a malware analysis lab locally üë®‚Äçüî¨ üî¨ - (B)rootware Research" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://brootware.github.io/posts/creating-a-malware-analysis-lab-locally/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/sensitive-data-redaction-pyredactkit/">Sensitive data redaction/unredaction tool - PyRedactKit üß∞üîêüìù</a><li><a href="/posts/regex-performance-in-golang-and-rust-which-is-faster/">Regex performance in golang and rust. Which is faster? ü§î</a><li><a href="/posts/cyber-security-education/">Cyber Security Education üîê üïµÔ∏è üéì</a><li><a href="/posts/cyber-league-ctf-2022-writeups/">Cyber League CTF 2022 - Writeups üö©</a><li><a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/">Grepping for gold in JSON APIs with jq üîç üìÑ</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/automating-kali-toolkit-installation/"><div class="card-body"> <em class="timeago small" date="2022-02-12 17:53:00 +0800" >Feb 12, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Automating kali toolkit installation üß∞</h3><div class="text-muted small"><p> Introduction As security professionals, it could be very time consuming to spin up a kali machine with all the tools needed to do any form of Red or Blue team work like bug bounty, threat hunting ...</p></div></div></a></div><div class="card"> <a href="/posts/creating-a-malware-analysis-lab-in-the-cloud/"><div class="card-body"> <em class="timeago small" date="2022-02-21 21:16:00 +0800" >Feb 21, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Creating a malware analysis lab in the cloud ‚òÅÔ∏è üî¨</h3><div class="text-muted small"><p> Introduction This is the continuation of part 1: creating a malware analysis lab locally. To recap in part 1 we setup a flare vm by mandiant and create an image as a vagrant box to be uploaded to ...</p></div></div></a></div><div class="card"> <a href="/posts/privacy-is-sexy/"><div class="card-body"> <em class="timeago small" date="2022-03-03 19:45:00 +0800" >Mar 3, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Privacy is sexy üçëüçÜ</h3><div class="text-muted small"><p> Introduction As a technology professional, I am agnostic when it comes to operating systems. The only thing I am concerned about is how the hardware and tools I use will help me be productive and ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/detecting-and-defending-against-log4j-attacks/" class="btn btn-outline-primary" prompt="Older"><p>Detecting and defending against log4j attacks ü™µ 4Ô∏è‚É£ üêö</p></a> <a href="/posts/creating-a-malware-analysis-lab-in-the-cloud/" class="btn btn-outline-primary" prompt="Newer"><p>Creating a malware analysis lab in the cloud ‚òÅÔ∏è üî¨</p></a></div><script src="https://utteranc.es/client.js" repo="brootware/brootware.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2023 <a href="https://github.com/brootware">Oaker Min (Bruce)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E65Q2J8381"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E65Q2J8381'); }); </script>
