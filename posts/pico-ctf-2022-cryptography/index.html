<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Pico CTF 2022: Cryptography 🔒 🕵" /><meta property="og:locale" content="en" /><meta name="description" content="basic-mod1" /><meta property="og:description" content="basic-mod1" /><link rel="canonical" href="https://brootware.github.io/posts/pico-ctf-2022-cryptography/" /><meta property="og:url" content="https://brootware.github.io/posts/pico-ctf-2022-cryptography/" /><meta property="og:site_name" content="(B)rootware Research" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-04T11:35:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Pico CTF 2022: Cryptography 🔒 🕵" /><meta name="twitter:site" content="@brootware" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"dateModified":"2022-04-08T20:10:22+08:00","datePublished":"2022-04-04T11:35:00+08:00","description":"basic-mod1","mainEntityOfPage":{"@type":"WebPage","@id":"https://brootware.github.io/posts/pico-ctf-2022-cryptography/"},"url":"https://brootware.github.io/posts/pico-ctf-2022-cryptography/","@type":"BlogPosting","headline":"Pico CTF 2022: Cryptography 🔒 🕵","@context":"https://schema.org"}</script><title>Pico CTF 2022: Cryptography 🔒 🕵 | (B)rootware Research</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="(B)rootware Research"><meta name="application-name" content="(B)rootware Research"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7734956?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">(B)rootware Research</a></div><div class="site-subtitle font-italic">Cloud DevOps / Site Reliability Engineering, Cyber Security</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/brootware" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/brootware" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/oakermin" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Pico CTF 2022: Cryptography 🔒 🕵</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Pico CTF 2022: Cryptography 🔒 🕵</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/brootware">Oaker Min (Bruce)</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-04-04 11:35:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Mon, Apr 4, 2022, 11:35 AM +0800" >Apr 4, 2022</em> </span> <span> Updated <em class="timeago" date="2022-04-08 20:10:22 +0800 " data-toggle="tooltip" data-placement="bottom" title="Fri, Apr 8, 2022, 8:10 PM +0800" >Apr 8, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1110 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h2 id="basic-mod1">basic-mod1<a href="#basic-mod1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We found this weird message being passed around on the servers, we think we have a working decrpytion scheme. Download the message here. Take each number mod 37 and map it to the following character set: 0-25 is the alphabet (uppercase), 26-35 are the decimal digits, and 36 is an underscore. Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">string</span>

<span class="n">deciDigits</span> <span class="o">=</span> <span class="p">[</span><span class="s">'26'</span><span class="p">,</span> <span class="s">'27'</span><span class="p">,</span> <span class="s">'28'</span><span class="p">,</span> <span class="s">'29'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'31'</span><span class="p">,</span> <span class="s">'32'</span><span class="p">,</span> <span class="s">'33'</span><span class="p">,</span> <span class="s">'34'</span><span class="p">,</span> <span class="s">'35'</span><span class="p">]</span>
<span class="n">numDict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">deciDigits</span><span class="p">)):</span>
    <span class="n">numDict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">deciDigits</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">numDict</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">numDict</span><span class="p">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">alphaDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">readFileNDecode</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'message.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">msg_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">msg</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">msg_list</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">modNum</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">37</span>
            <span class="k">if</span> <span class="n">modNum</span> <span class="o">&lt;</span> <span class="mi">26</span><span class="p">:</span>
                <span class="n">flag</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphaDict</span><span class="p">[</span><span class="n">modNum</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">modNum</span> <span class="o">&lt;</span> <span class="mi">36</span><span class="p">:</span>
                <span class="n">flag</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">numDict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">modNum</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="n">modNum</span> <span class="o">==</span> <span class="mi">36</span><span class="p">:</span>
                <span class="n">flag</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'_'</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="n">picoFlag</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'picoCTF{{</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s">}}'</span>
        <span class="k">print</span><span class="p">(</span><span class="n">picoFlag</span><span class="p">)</span>
        
    
<span class="n">readFileNDecode</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>➜  basicmod1 python basicmod1.py 
picoCTF<span class="o">{</span>R0UND_N_R0UND_8C863EE7<span class="o">}</span>
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{R0UND_N_R0UND_8C863EE7}</code></p><h2 id="substitution0">substitution0<a href="#substitution0" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>A message has come in but it seems to be all scrambled. Luckily it seems to have the key at the beginning. Can you crack this substitution cipher?</p><p>Cipher text as below. The key is the <code class="language-plaintext highlighter-rouge">PAQZTNDSRYWFEXGJKCVLBUHOMI</code></p><div class="language-text highlighter-rouge"><div class="code-header"> <span label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>PAQZTNDSRYWFEXGJKCVLBUHOMI 

Stctbjgx Ftdcpxz pcgvt, hrls p dcput pxz vlpltfm prc, pxz acgbdsl et lst attlft
ncge p dfpvv qpvt rx hsrqs rl hpv txqfgvtz. Rl hpv p atpblrnbf vqpcpaptbv, pxz, pl
lspl lret, bxwxghx lg xplbcpfrvlv—gn qgbcvt p dctpl jcrit rx p vqrtxlrnrq jgrxl
gn urth. Lstct htct lhg cgbxz afpqw vjglv xtpc gxt tolcterlm gn lst apqw, pxz p
fgxd gxt xtpc lst glstc. Lst vqpftv htct toqttzrxdfm spcz pxz dfgvvm, hrls pff lst
pjjtpcpxqt gn abcxrvstz dgfz. Lst htrdsl gn lst rxvtql hpv utcm ctepcwpaft, pxz,
lpwrxd pff lsrxdv rxlg qgxvrztcplrgx, R qgbfz spczfm afpet Ybjrltc ngc srv gjrxrgx
ctvjtqlrxd rl.

Lst nfpd rv: jrqgQLN{5BA5717B710X_3U0FB710X_PP1QQ2A7}
</pre></table></code></div></div><p>Using <a href="https://www.dcode.fr/substitution-monoalphabetique">https://www.dcode.fr/substitution-monoalphabetique</a></p><div class="language-text highlighter-rouge"><div class="code-header"> <span label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>HEREUPON LEGRAND AROSE, WITH A GRAVE AND STATELY AIR, AND BROUGHT ME THE BEETLE
FROM A GLASS CASE IN WHICH IT WAS ENCLOSED. IT WAS A BEAUTIFUL SCARABAEUS, AND, AT
THAT TIME, UNKNOWN TO NATURALISTS--OF COURSE A GREAT PRIZE IN A SCIENTIFIC POINT
OF VIEW. THERE WERE TWO ROUND BLACK SPOTS NEAR ONE EXTREMITY OF THE BACK, AND A
LONG ONE NEAR THE OTHER. THE SCALES WERE EXCEEDINGLY HARD AND GLOSSY, WITH ALL THE
APPEARANCE OF BURNISHED GOLD. THE WEIGHT OF THE INSECT WAS VERY REMARKABLE, AND,
TAKING ALL THINGS INTO CONSIDERATION, I COULD HARDLY BLAME JUPITER FOR HIS OPINION
RESPECTING IT.

THE FLAG IS: PICOCTF{5UB5717U710N_3V0LU710N_AA1CC2B7}
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">PICOCTF{5UB5717U710N_3V0LU710N_AA1CC2B7}</code></p><h2 id="basic-mod2">basic-mod2<a href="#basic-mod2" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Description</p><p>A new modular challenge! Download the message here. Take each number mod 41 and find the modular inverse for the result. Then map to the following character set: 1-26 are the alphabet, 27-36 are the decimal digits, and 37 is an underscore. Wrap your decrypted message in the picoCTF flag format (i.e. picoCTF{decrypted_message})</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">string</span>

<span class="n">deciDigits</span> <span class="o">=</span> <span class="p">[</span><span class="s">'27'</span><span class="p">,</span> <span class="s">'28'</span><span class="p">,</span> <span class="s">'29'</span><span class="p">,</span> <span class="s">'30'</span><span class="p">,</span> <span class="s">'31'</span><span class="p">,</span> <span class="s">'32'</span><span class="p">,</span> <span class="s">'33'</span><span class="p">,</span> <span class="s">'34'</span><span class="p">,</span> <span class="s">'35'</span><span class="p">,</span> <span class="s">'36'</span><span class="p">]</span>
<span class="n">numDict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">deciDigits</span><span class="p">)):</span>
    <span class="n">numDict</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">deciDigits</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">numDict</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">numDict</span><span class="p">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">alphaDict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="s">'''helper function to find modinv'''</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">modinv</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="s">'''helper function to find modinv'''</span>
    <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">egcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'modular inverse does not exist'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">m</span>


<span class="k">def</span> <span class="nf">readFileNDecode</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'message.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">msg_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">msg</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">msg_list</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">modInvNum</span> <span class="o">=</span> <span class="n">modinv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">modInvNum</span> <span class="o">&lt;</span> <span class="mi">27</span><span class="p">:</span>
                <span class="n">flag</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphaDict</span><span class="p">[</span><span class="n">modInvNum</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">modInvNum</span> <span class="o">&lt;</span> <span class="mi">37</span><span class="p">:</span>
                <span class="n">flag</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">numDict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">modInvNum</span><span class="p">)])</span>
            <span class="k">elif</span> <span class="n">modInvNum</span> <span class="o">==</span> <span class="mi">37</span><span class="p">:</span>
                <span class="n">flag</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'_'</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="n">picoFlag</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"picoCTF{{</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s">}}"</span>
        <span class="k">print</span><span class="p">(</span><span class="n">picoFlag</span><span class="p">)</span>


<span class="n">readFileNDecode</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>➜  pico2022 git:<span class="o">(</span>main<span class="o">)</span> ✗ python basicmod2.py 
picoCTF<span class="o">{</span>1NV3R53LY_H4RD_F6747912<span class="o">}</span>
</pre></table></code></div></div><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{1NV3R53LY_H4RD_F6747912}</code></p><h2 id="vignere">Vignere<a href="#vignere" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Can you decrypt this message? Decrypt this message using this key “CYLAB”. <code class="language-plaintext highlighter-rouge">rgnoDVD{O0NU_WQ3_G1G3O3T3_A1AH3S_e481bf5f}</code></p><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{D0NT_US3_V1G3N3R3_C1PH3R_c481du5f}</code> Using <a href="https://www.dcode.fr/vigenere-cipher">https://www.dcode.fr/vigenere-cipher</a></p><h2 id="credstuff">credstuff<a href="#credstuff" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We found a leak of a blackmarket website’s login credentials. Can you find the password of the user cultiris and successfully decrypt it? Download the leak here. The first user in usernames.txt corresponds to the first password in passwords.txt. The second user corresponds to the second password, and so on.</p><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{C7r1F_54V35_71M3}</code></p><p><img data-src="https://bn1304files.storage.live.com/y4mV2YsQWbh2VIpNw1ad0aNSTaB9erEuzEMB9qn9DTePZHr4nV4lXLI5qndi1Tx9uN68wZtIGR8eMrOFKm557DhO1xLUbd-H7RWg2F4ChV4SQ3ofSwZJX0kExHhr-HdHcKKfgM6j-uhjSvAPASK1FznFL8Gu29MVGecj0z17Ek40INgP7XotnjmZzjb83Yglk_1?width=2654&amp;height=1620&amp;cropmode=none" alt="image" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">cultiris:cvpbPGS{P7e1S_54I35_71Z3}</code></p><p>Using <a href="https://www.dcode.fr/caesar-cipher">caesar-cipher</a>.</p><h2 id="rail-fence">rail-fence<a href="#rail-fence" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>A type of transposition cipher is the rail fence cipher, which is described here. Here is one such cipher encrypted using the rail fence with 4 rails. Can you decrypt it? Download the message here. Put the decoded message in the picoCTF flag format, picoCTF{decoded_message}. <code class="language-plaintext highlighter-rouge">Ta _7N6D54hlg:W3D_H3C31N__510ef sHR053F38N43D28 i33___N2</code></p><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{WH3R3_D035_7H3_F3NC3_8361N_4ND_3ND_55228140}</code></p><p>Using cyberchef : <a href="https://gchq.github.io/CyberChef/#recipe=Rail_Fence_Cipher_Decode(4,0)&amp;input=VGEgXzdONkQ1NGhsZzpXM0RfSDNDMzFOX181MTBlZiBzSFIwNTNGMzhONDNEMjggaTMzX19fTjI">https://gchq.github.io/CyberChef/#recipe=Rail_Fence_Cipher_Decode(4,0)&amp;input=VGEgXzdONkQ1NGhsZzpXM0RfSDNDMzFOX181MTBlZiBzSFIwNTNGMzhONDNEMjggaTMzX19fTjI</a></p><p><code class="language-plaintext highlighter-rouge">The flag is: WH3R3_D035_7H3_F3NC3_8361N_4ND_3ND_55228140</code></p><h2 id="substitution1">substitution1<a href="#substitution1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>A second message has come in the mail, and it seems almost identical to the first one. Maybe the same thing will work again. Download the message here.</p><p><code class="language-plaintext highlighter-rouge">WILh (hjpai lpa wrtikan ijn lbrc) ran r ietn pl wpgtkina hnwkazie wpgtnizizpu. Wpuinhiruih ran tanhnuiny szij r hni pl wjrbbnucnh sjzwj inhi ijnza wanrizdzie, inwjuzwrb (ruy cppcbzuc) hfzbbh, ruy tapobng-hpbdzuc rozbzie. Wjrbbnucnh khkrbbe wpdna r ukgona pl wrincpaznh, ruy sjnu hpbdny, nrwj eznbyh r hiazuc (wrbbny r lbrc) sjzwj zh hkogziiny ip ru pubzun hwpazuc hnadzwn. WILh ran r canri sre ip bnrau r szyn raare pl wpgtkina hnwkazie hfzbbh zu r hrln, bncrb nudzapugnui, ruy ran jphiny ruy tbreny oe grue hnwkazie capkth rapkuy ijn spaby lpa lku ruy tarwizwn. Lpa ijzh tapobng, ijn lbrc zh: tzwpWIL{LA3VK3UWE_4774WF5_4A3_W001_O810YY84}</code></p><p>Flag : <code class="language-plaintext highlighter-rouge">picoCTF{FR3QU3NCY_4774CK5_4R3_C001_B810DD84}</code></p><p>Using <a href="https://www.dcode.fr/monoalphabetic-substitution">https://www.dcode.fr/monoalphabetic-substitution</a></p><p><code class="language-plaintext highlighter-rouge">CTFS (SHORT FOR CAPTURE THE FLAG) ARE A TYPE OF COMPUTER SECURITY COMPETITION. CONTESTANTS ARE PRESENTED WITH A SET OF CHALLENGES WHICH TEST THEIR CREATIVITY, TECHNICAL (AND GOOGLING) SKILLS, AND PROBLEM-SOLVING ABILITY. CHALLENGES USUALLY COVER A NUMBER OF CATEGORIES, AND WHEN SOLVED, EACH YIELDS A STRING (CALLED A FLAG) WHICH IS SUBMITTED TO AN ONLINE SCORING SERVICE. CTFS ARE A GREAT WAY TO LEARN A WIDE ARRAY OF COMPUTER SECURITY SKILLS IN A SAFE, LEGAL ENVIRONMENT, AND ARE HOSTED AND PLAYED BY MANY SECURITY GROUPS AROUND THE WORLD FOR FUN AND PRACTICE. FOR THIS PROBLEM, THE FLAG IS: PICOCTF{FR3QU3NCY_4774CK5_4R3_C001_B810DD84}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/cryptography/'>Cryptography</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >CTF</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >Cryptography</a> <a href="/tags/picoctf-2022/" class="post-tag no-text-decoration" >picoctf-2022</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Pico CTF 2022: Cryptography 🔒 🕵 - (B)rootware Research&url=https://brootware.github.io/posts/pico-ctf-2022-cryptography/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Pico CTF 2022: Cryptography 🔒 🕵 - (B)rootware Research&u=https://brootware.github.io/posts/pico-ctf-2022-cryptography/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://brootware.github.io/posts/pico-ctf-2022-cryptography/&text=Pico CTF 2022: Cryptography 🔒 🕵 - (B)rootware Research" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://brootware.github.io/posts/pico-ctf-2022-cryptography/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/sensitive-data-redaction-pyredactkit/">Sensitive data redaction/unredaction tool - PyRedactKit 🧰🔐📝</a><li><a href="/posts/regex-performance-in-golang-and-rust-which-is-faster/">Regex performance in golang and rust. Which is faster? 🤔</a><li><a href="/posts/cyber-security-education/">Cyber Security Education 🔐 🕵️ 🎓</a><li><a href="/posts/cyber-league-ctf-2022-writeups/">Cyber League CTF 2022 - Writeups 🚩</a><li><a href="/posts/grepping-for-gold-in-JSON-APIs-with-jq/">Grepping for gold in JSON APIs with jq 🔍 📄</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/picomini22pwcrack5/"><div class="card-body"> <em class="timeago small" date="2022-01-15 10:22:00 +0800" >Jan 15, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Beginner picoMini 2022 password crack 5 🚩</h3><div class="text-muted small"><p> Point: 100 Category Cryptography, Reverse-Engineering Question Can you crack the password to get the flag? Download the password checker here and you’ll need the encrypted flag and the hash i...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-web-exploitation/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:27:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Web-exploitation 🏁 🕸 👨🏻‍💻</h3><div class="text-muted small"><p> Local Authority Can you get the flag? Go to this website and see what you can discover. Flag : picoCTF{j5_15_7r4n5p4r3n7_6309e949} First we tried to login using random username and password to g...</p></div></div></a></div><div class="card"> <a href="/posts/pico-ctf-2022-forensics/"><div class="card-body"> <em class="timeago small" date="2022-04-04 11:31:00 +0800" >Apr 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pico CTF 2022: Forensics 🕵️ 🏁</h3><div class="text-muted small"><p> Enhance Download this image file and find the flag. strings drawing.flag.svg picoCTF{3nh4nc3d_58bd3420} Flag : picoCTF{3nh4nc3d_58bd3420} Lookey here Attackers have hidden information in a ve...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pico-ctf-2022-forensics/" class="btn btn-outline-primary" prompt="Older"><p>Pico CTF 2022: Forensics 🕵️ 🏁</p></a> <a href="/posts/pico-ctf-2022-binary-exploitation/" class="btn btn-outline-primary" prompt="Newer"><p>Pico CTF 2022: Binary Exploitation ⚙️ 🛠</p></a></div><script src="https://utteranc.es/client.js" repo="brootware/brootware.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/brootware">Oaker Min (Bruce)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">CTF</a> <a class="post-tag" href="/tags/projects/">Projects</a> <a class="post-tag" href="/tags/blue-team/">Blue-team</a> <a class="post-tag" href="/tags/dfir/">DFIR</a> <a class="post-tag" href="/tags/forensics/">Forensics</a> <a class="post-tag" href="/tags/picoctf-2022/">picoctf-2022</a> <a class="post-tag" href="/tags/security-toolkit/">security-toolkit</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/general-tech/">General-tech</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E65Q2J8381"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E65Q2J8381'); }); </script>
